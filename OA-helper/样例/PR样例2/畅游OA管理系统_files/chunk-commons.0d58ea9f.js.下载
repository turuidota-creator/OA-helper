(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-commons"],{"4ff8":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"表达式内容",prop:"expression"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入表达式内容"},on:{input:e.forceUpdate,change:function(t){return e.translateExpressionToChinese(e.form.expression)}},model:{value:e.form.expression,callback:function(t){e.$set(e.form,"expression",t)},expression:"form.expression"}}),a("span",{staticStyle:{"font-size":"12px",color:"#1ab394"}},[e._v("释义："+e._s(e.expressionExplanation))]),a("el-alert",{attrs:{size:"mini",type:"info",title:"翻译说明：",description:"组件唯一名称若带有userId(不区分大小写),将会被翻译出用户名，否则不做处理；其余类似，如{部门名，deptId}，{产品名称，productId}"}})],1),a("el-form-item",{attrs:{label:"规则设定",prop:"formName"}},[a("div",{staticStyle:{"max-height":"500px","overflow-y":"scroll"}},e._l(e.forms,(function(t,o){return a("el-card",{key:t.formId},[a("h1",[e._v(e._s(t.formName))]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData[o],height:"250",border:"","header-cell-style":{"text-align":"left"}}},[a("el-table-column",{attrs:{label:"组件标签",width:"200"},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.row;r.$index;return[a("el-select",{on:{change:function(t){return e.onLabelChange(n,o)}},model:{value:n.label,callback:function(t){e.$set(n,"label",t)},expression:"row.label"}},e._l(t.widgetList,(function(t){return a("el-option",{key:t.uniqueName,attrs:{label:t.label,value:t.uniqueName}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))]),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.uniqueName))])])})),1)]}}],null,!0)}),a("el-table-column",{attrs:{prop:"uniqueName",label:"组件唯一名称",width:"200","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"比较运算符",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("el-select",{on:{change:function(t){return e.consoleLog(o)}},model:{value:o.operator,callback:function(t){e.$set(o,"operator",t)},expression:"row.operator"}},[a("el-option",{attrs:{label:"等于",value:"=="}}),a("el-option",{attrs:{label:"不等于",value:"!="}}),a("el-option",{attrs:{label:"大于",value:">"}}),a("el-option",{attrs:{label:"小于",value:"<"}}),a("el-option",{attrs:{label:"大于等于",value:">="}}),a("el-option",{attrs:{label:"小于等于",value:"<="}}),a("el-option",{attrs:{label:"包含",value:"contain"}}),a("el-option",{attrs:{label:"不包含",value:"!contain"}})],1)]}}],null,!0)}),a("el-table-column",{attrs:{label:"值"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return["input"===o.type?a("el-input",{model:{value:o.value,callback:function(t){e.$set(o,"value",t)},expression:"row.value"}}):"number"===o.type?a("el-input-number",{model:{value:o.value,callback:function(t){e.$set(o,"value",t)},expression:"row.value"}}):"radio"===o.type?a("el-radio-group",{model:{value:o.value,callback:function(t){e.$set(o,"value",t)},expression:"row.value"}},e._l(o.optionItems,(function(t){return a("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1):"rate"===o.type?a("el-rate",{model:{value:o.value,callback:function(t){e.$set(o,"value",t)},expression:"row.value"}}):"textarea"===o.type?a("el-input",{attrs:{type:"textarea"},model:{value:o.value,callback:function(t){e.$set(o,"value",t)},expression:"row.value"}}):"select"===o.type?a("el-select",{model:{value:o.value,callback:function(t){e.$set(o,"value",t)},expression:"row.value"}},e._l(o.optionItems,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):"date-range"===o.type?a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:o.value,callback:function(t){e.$set(o,"value",t)},expression:"row.value"}}):"checkbox"===o.type?a("el-checkbox-group",{model:{value:o.value,callback:function(t){e.$set(o,"value",t)},expression:"row.value"}},e._l(o.optionItems,(function(t){return a("el-checkbox",{key:t.value,attrs:{label:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1):"switch"===o.type?a("el-switch",{model:{value:o.value,callback:function(t){e.$set(o,"value",t)},expression:"row.value"}}):"date"===o.type?a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:o.value,callback:function(t){e.$set(o,"value",t)},expression:"row.value"}}):"cascader"===o.type?a("el-cascader",{attrs:{options:o.optionItems},model:{value:o.value,callback:function(t){e.$set(o,"value",t)},expression:"row.value"}}):e._e()]}}],null,!0)}),a("el-table-column",{attrs:{label:"选择器",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.openDiaglog(o,"PersonSelector","userId")}}},[e._v("人员 ")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.openDiaglog(o,"DeptSelector","id")}}},[e._v("部门 ")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.openDiaglog(o,"RoleSignalSelector","roleId")}}},[e._v("角色 ")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.openDiaglog(o,"SealProductSelector","code")}}},[e._v("应用产品 ")]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.openDiaglog(o,"ProjectSelector","projectCode")}}},[e._v("费用归属项目 ")])]}}],null,!0)}),a("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.$index;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.removeRow(o,r)}}},[e._v("移除")])]}}],null,!0)})],1),a("el-button",{on:{click:function(t){return e.addRow(o)}}},[e._v("添加行")])],1)})),1),a("el-alert",{attrs:{size:"mini",title:"未完整填写行将被跳过",type:"info"}}),a("el-button",{on:{click:function(t){return e.submitTableData("&&")}}},[e._v("and提交")]),a("el-button",{on:{click:function(t){return e.submitTableData("||")}}},[e._v("or提交")])],1)],1)],1)},r=[],n=a("53ca"),l=a("b85c"),i=(a("99af"),a("7db0"),a("a15b"),a("d81d"),a("14d9"),a("a434"),a("e9c4"),a("b64b"),a("d3b7"),a("ac1f"),a("25f0"),a("5319"),a("5b81"),a("0643"),a("fffc"),a("4e3e"),a("a573"),a("159b"),a("e3ab")),s={name:"ExpressionBuilder",props:{},data:function(){return{forms:[],tableData:[],expressionExplanation:"",form:{expression:""},rules:{},widgetMap:{}}},created:function(){},methods:{consoleLog:function(e){console.log(e)},onLabelChange:function(e,t){var a=e.label,o=this.forms[t].widgetList.find((function(e){return e.uniqueName===a}));o&&Object.assign(e,o),"checkbox"===e.type?e.value=[]:e.value=""},addRow:function(e){var t={label:"",uniqueName:"",operator:"",type:"",value:"",optionItems:[]};this.tableData[e].push(t)},removeRow:function(e,t){this.tableData[e].splice(t,1)},initialization:function(e){var t=this;void 0===e&&(e=""),this.expressionExplanation="",this.form.expression=e.replace(/\$\{(.*)}/,"$1");var a=JSON.parse(localStorage.getItem("nowExpressionFormIds"));console.log("formIds",a),void 0!==a&&null!==a&&""!==a||(a=[]),Object(i["f"])(a).then((function(e){t.forms=e.data,t.widgetMap={},t.forms.forEach((function(e){e.widgetList.forEach((function(e){t.widgetMap[e.uniqueName]=e}))}));for(var a=0;a<t.forms.length&&t.tableData.length<t.forms.length;a++)t.tableData.push([]);t.translateExpressionToChinese(t.form.expression)}))},translateExpressionToChinese:function(e){var t=this;e&&Object(i["b"])(e).then((function(a){200===a.code&&(e=a.data),e=e.replaceAll("&&","且"),e=e.replaceAll("||","或"),e=t.convertCascader(e),e=t.convertContain(e),e=t.convertBoolean(e),e=t.convertCheckBox(e),e=t.convertUserRole(e),e=t.convertVariableCompare(e),e=t.convertSimpleNumber(e),t.expressionExplanation=e}))},openDiaglog:function(e,t,a){var o=this,r=this.$createElement,n="".concat(t,"_").concat((new Date).getTime());this.$nextTick((function(){o.$msgbox({title:"选择器",message:r("div",null,[r(t,{ref:n,props:{isSingle:!0}})]),customClass:"winClass",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:function(t,r,l){"confirm"===t?o.$nextTick().then((function(){if(o.$refs[n]){var t=o.$refs[n].getSelectedNodes();console.log("Selected rows:",t),e.value=t[a],l()}else console.error("组件未找到"),l()})):o.$nextTick().then((function(){o.$refs[n]?(o.$refs[n].clearSelectionNode(),l()):(console.error("组件未找到"),l())}))}})}))},forceUpdate:function(){this.$forceUpdate()},submitTableData:function(e){console.log(this.tableData);for(var t="",a=0;a<this.tableData.length;a++)for(var o=0;o<this.tableData[a].length;o++)""!==this.tableData[a][o].uniqueName&&""!==this.tableData[a][o].operator&&""!==this.tableData[a][o].value&&(""!==t&&(t+=" && "),t+=this.convertToTrueExpression(this.tableData[a][o]));console.log("res",t),""!==t&&(t="("+t+")"),this.form.expression+=""===this.form.expression?t:" ".concat(e," ").concat(t),this.translateExpressionToChinese(this.form.expression),this.$forceUpdate()},convertContain:function(e){var t,a=/(!)?(\w+)\.contains\("(\d+)"\)/g,o=e;while(null!==(t=a.exec(e))){var r="!"===t[1]?"不":"",n=t[2],l=t[3],i=this.widgetMap[n];i&&(o=o.replace(t[0],"".concat(i.label," ").concat(r,"包含 ").concat(l)))}return o},convertBoolean:function(e){var t,a=/\b(\w+)\b\s*(!=|==)\s*(true|false)/g,o=e;while(null!==(t=a.exec(e))){var r=t[1],n=t[2],l="true"===t[3]?"是":"否",i=this.widgetMap[r];i&&(o=o.replace(t[0],"".concat(i.label," ").concat(n," ").concat(l)))}return o},convertCheckBox:function(e){var t,a=/(!?)\s*FlowableExtraFunc\.(checkBoxEqual|checkBoxContain)\(([^,]+),\s*"(.*?)"\)\s*/g,o=e;while(null!==(t=a.exec(e))){var r="!"===t[1]?"不":"",n="checkBoxEqual"===t[2]?"等于":"包含",l=t[3],i=t[4],s=this.widgetMap[l];if(s){for(var c=i.split(","),u="",p=0;p<c.length;p++)u+=this.findLabelByValue(s.optionItems,c[p]),p!==c.length-1&&(u+=",");o=o.replace(t[0],"".concat(s.label," 选中项 ").concat(r).concat(n," [").concat(u,"]"))}}return o},convertUserRole:function(e){var t,a=/(!?)\s*FlowableExtraFunc\.(userRoleEqual|userRoleContain)\([^,]+,\s*"(.*?)"\)\s*/g,o=e;while(null!==(t=a.exec(e))){var r="!"===t[1]?"不":"",n="userRoleEqual"===t[2]?"等于":"包含",l=t[3],i=this.widgetMap["roleNameCompare"];i&&(o=o.replace(t[0],"".concat(i.label," ").concat(r).concat(n," [").concat(l,"]")))}return o},convertVariableCompare:function(e){var t,a=/(\w+)\s*([=><!]+)\s*(\w+)/g,o=e;while(null!==(t=a.exec(e))){var r=t[1],n=t[2],l=t[3],i=this.widgetMap[r],s=this.widgetMap[l];i&&s&&(o=o.replace(t[0],"".concat(i.label," ").concat(n," ").concat(s.label)))}return o},convertSimpleNumber:function(e){var t,a=/\b(\w+)\b\s*(>=|<=|!=|==|>|<)\s*(\d+|"[^"]*"|'[^']*')/g,o=e;while(null!==(t=a.exec(e))){var r=t[1],n=t[2],l=t[3],i=this.widgetMap[r];i&&(o=o.replace(t[0],"".concat(i.label," ").concat(n," ").concat(this.findLabelByValue(i.optionItems,l))))}return o},convertCascader:function(e){var t,a=/\b(\w+)\[(\d+)\]\s*(==|!=|>|<|>=|<=)\s*(\d+|"[^"]*"|'[^']*')/g,o=e;while(null!==(t=a.exec(e))){var r=t[1],n=t[2],l=t[3],i=t[4],s=this.widgetMap[r];s&&(o=o.replace(t[0],"".concat(s.label,"[").concat(n,"] ").concat(l," ").concat(this.findLabelByValue(s.optionItems,i))))}return o},findLabelByValue:function(e,t){var a,o=Object(l["a"])(e);try{for(o.s();!(a=o.n()).done;){var r=a.value;if(r.value==t)return r.label;if(r.children&&r.children.length>0){var n=this.findLabelByValue(r.children,t);if(void 0!==n)return n}}}catch(i){o.e(i)}finally{o.f()}return t},convertToTrueExpression:function(e){var t=this,a="",o=e.value;return"roleNameCompare"===e.uniqueName?"contain"===e.operator?a='FlowableExtraFunc.userRoleContain(initiatorUserId,"'.concat(o.toString(),'")'):"!contain"===e.operator?a='!FlowableExtraFunc.userRoleContain(initiatorUserId,"'.concat(o.toString(),'")'):"=="===e.operator?a='FlowableExtraFunc.userRoleEqual(initiatorUserId,"'.concat(o.toString(),'")'):"!="===e.operator&&(a='!FlowableExtraFunc.userRoleEqual(initiatorUserId,"'.concat(o.toString(),'")')):"checkbox"===e.type?"contain"===e.operator?a="FlowableExtraFunc.checkBoxContain(".concat(e.uniqueName,',"').concat(o.toString(),'")'):"!contain"===e.operator?a="!FlowableExtraFunc.checkBoxContain(".concat(e.uniqueName,',"').concat(o.toString(),'")'):"=="===e.operator?a="FlowableExtraFunc.checkBoxEqual(".concat(e.uniqueName,',"').concat(o.toString(),'")'):"!="===e.operator&&(a="!FlowableExtraFunc.checkBoxEqual(".concat(e.uniqueName,',"').concat(o.toString(),'")')):a=Array.isArray(o)?o.map((function(a,o){return"".concat(e.uniqueName,"[").concat(o,"] ").concat(e.operator," ").concat(t.wrapValue(a,Object(n["a"])(a)))})).join(" && "):"contain"===e.operator?"".concat(e.uniqueName,".contains(").concat(this.wrapValue(o,"string"),")"):"!contain"===e.operator?"!".concat(e.uniqueName,".contains(").concat(this.wrapValue(o,"string"),")"):"".concat(e.uniqueName," ").concat(e.operator," ").concat(this.wrapValue(o,Object(n["a"])(o))),a},wrapValue:function(e,t){return"string"===t?'"'.concat(e,'"'):"boolean"===t||null===e||void 0===e||"object"===t&&null!==e?JSON.stringify(e):e},getExpression:function(){return this.form.expression||this.$message.error("表达式不能为空"),this.form.expression}}},c=s,u=(a("53ea"),a("2877")),p=Object(u["a"])(c,o,r,!1,null,null,null);t["a"]=p.exports},"53ea":function(e,t,a){"use strict";a("a4344")},6524:function(e,t,a){},"791f":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,size:e.searchSize,inline:!0}},[a("el-form-item",{attrs:{label:"流程编号",prop:"requestMark"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"请输入流程编号",clearable:"",size:e.searchSize},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery.apply(null,arguments)}},model:{value:e.queryParams.requestMark,callback:function(t){e.$set(e.queryParams,"requestMark",t)},expression:"queryParams.requestMark"}})],1),a("el-form-item",{attrs:{label:"流程标题",prop:"requestName"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"请输入流程标题",clearable:"",size:e.searchSize},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery.apply(null,arguments)}},model:{value:e.queryParams.requestName,callback:function(t){e.$set(e.queryParams,"requestName",t)},expression:"queryParams.requestName"}})],1),a("el-form-item",{attrs:{label:"",prop:"isApprovedByMe"}},[a("el-checkbox-group",{on:{change:e.handleFlowTypeChange},model:{value:e.queryParams.isApprovedByMe,callback:function(t){e.$set(e.queryParams,"isApprovedByMe",t)},expression:"queryParams.isApprovedByMe"}},e._l(e.flowTypes,(function(t){return a("el-checkbox-button",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),e.inTab?e._e():a("el-row",{staticStyle:{"padding-bottom":"10px"},attrs:{gutter:10}},[a("right-toolbar",{attrs:{showSearch:e.showSearch},on:{"update:showSearch":function(t){e.showSearch=t},"update:show-search":function(t){e.showSearch=t},queryTable:e.getList}})],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.flowData,border:""}},[a("el-table-column",{attrs:{prop:"requestMark",label:"流程编号","show-overflow-tooltip":"",width:"220"}}),a("el-table-column",{attrs:{prop:"workflowName",label:"流程标题","show-overflow-tooltip":"","min-width":"220"}}),a("el-table-column",{attrs:{prop:"requestName",label:"标题","show-overflow-tooltip":"","min-width":"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{staticStyle:{"font-size":"10pt"},attrs:{type:"primary",underline:!1},on:{click:function(a){return e.toProcessDetail(t.row)}}},[e._v(e._s(t.row.requestName))])]}}])}),a("el-table-column",{attrs:{prop:"creatorName",label:"申请人","show-overflow-tooltip":"",width:"160"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间","show-overflow-tooltip":"",width:"160"}})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}})],1)},r=[],n=a("c7eb"),l=a("5530"),i=a("1da1"),s=(a("d3b7"),a("04fe")),c={name:"OaFlow",props:{inTab:{type:Boolean,default:!1}},data:function(){return{flowData:[],loading:!0,showSearch:!0,queryParams:{pageNum:1,pageSize:10,requestMark:void 0,requestName:void 0,isApprovedByMe:["isRequestByMe"]},total:0,flowTypes:[{label:"我的请求",value:"isRequestByMe"},{label:"办结事宜",value:"isApprovedByMe"}]}},computed:{searchSize:function(){return this.inTab?"mini":"small"}},methods:{init:function(){this.getList(),console.log("oa flow init")},getList:function(){var e=this;return Object(i["a"])(Object(n["a"])().mark((function t(){var a,o,r,i;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,a=Object(l["a"])(Object(l["a"])({},e.queryParams),{},{isApprovedByMe:e.queryParams.isApprovedByMe[0]}),t.next=4,Object(s["b"])(a).finally((function(){return e.loading=!1}));case 4:o=t.sent,o.code,r=o.rows,i=o.total,e.flowData=r,e.total=i;case 10:case"end":return t.stop()}}),t)})))()},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},handleFlowTypeChange:function(){this.queryParams.isApprovedByMe.length>1&&this.queryParams.isApprovedByMe.shift(),this.handleQuery()},toProcessDetail:function(e){window.open("http://workflow.cyou-inc.com/login/Login.jsp?gopage=/workflow/request/ViewRequest.jsp?requestid=".concat(e.requestId))},calc:function(){return"70vh"}}},u=c,p=(a("bb8c"),a("2877")),m=Object(p["a"])(u,o,r,!1,null,"695c3c26",null);t["a"]=m.exports},"9a59":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"queryForm",attrs:{model:e.queryParams,size:"small",inline:!0,"label-width":"68px"}},[a("el-form-item",{attrs:{label:"共享类型"}},[a("el-select",{attrs:{placeholder:"请选择共享类型"},model:{value:e.queryParams.shareType,callback:function(t){e.$set(e.queryParams,"shareType",t)},expression:"queryParams.shareType"}},e._l(e.shareTypeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",attrs:{data:e.list,"max-height":"500","row-key":e.getFormRowKeys}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{label:"共享类型",align:"center",prop:"shareType"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(" "+e._s(["用户","角色","部门","表单字段"][t.row.shareType]||"")+" ")])]}}])}),a("el-table-column",{attrs:{label:"共享对象",align:"center",prop:"name"}})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}})],1)},r=[],n=a("21fb"),l={name:"ProcessShareInfo",props:{prId:{type:String,required:!0}},data:function(){return{loading:!0,total:0,list:[],queryParams:{pageNum:1,pageSize:10,shareType:void 0},shareTypeOptions:[{value:0,label:"用户"},{value:1,label:"角色"},{value:2,label:"部门"},{value:3,label:"表单字段"}]}},created:function(){this.getList()},methods:{getFormRowKeys:function(e){return e.prUserId},getList:function(){var e=this;this.loading=!0,this.queryParams.prId=this.prId,Object(n["f"])(this.queryParams).then((function(t){e.list=t.rows,e.total=t.total,e.loading=!1}))},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.queryParams.pageNum=1,this.queryParams.pageSize=10,this.queryParams.shareType=void 0,this.getList()}}},i=l,s=a("2877"),c=Object(s["a"])(i,o,r,!1,null,null,null);t["a"]=c.exports},a08b:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formQueryForm}},[a("el-form-item",{attrs:{label:"表单名",size:"mini"}},[a("el-input",{attrs:{placeholder:"请输入表单名",clearable:""},model:{value:e.formQueryForm.formName,callback:function(t){e.$set(e.formQueryForm,"formName",t)},expression:"formQueryForm.formName"}})],1),a("el-form-item",{attrs:{label:"流程分类",prop:"category"}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择",size:"small"},model:{value:e.formQueryForm.categoryId,callback:function(t){e.$set(e.formQueryForm,"categoryId",t)},expression:"formQueryForm.categoryId"}},e._l(e.categoryOptions,(function(e){return a("el-option",{key:e.categoryId,attrs:{label:e.categoryName,value:e.categoryId}})})),1)],1),a("el-form-item",{attrs:{size:"mini"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.getFormList}},[e._v("查询")])],1)],1),a("el-table",{ref:"formTable",attrs:{data:e.formTableList,height:"600",border:"","row-key":e.getFormRowKeys},on:{"selection-change":e.handleFormSelectionChange}},[a("el-table-column",{attrs:{type:"selection","reserve-selection":!0,width:"50",align:"center"}}),a("el-table-column",{attrs:{label:"表单名",align:"center",prop:"formName"}}),a("el-table-column",{attrs:{label:"流程分类",align:"center",prop:"categoryName"}}),a("el-table-column",{attrs:{label:"备注",align:"center",prop:"remark"}}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-view"},on:{click:function(a){return e.handleDetail(t.row)}}},[e._v("详情")])]}}])})],1),a("pagination",{attrs:{total:e.formTotal,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getFormList}}),a("el-dialog",{attrs:{title:e.formTitle,visible:e.formConfOpen,width:"60%","append-to-body":""},on:{"update:visible":function(t){e.formConfOpen=t}}},[a("div",{staticClass:"test-form"},[a("v-form-render",{ref:"vFormRef"})],1)])],1)},r=[],n=a("5530"),l=(a("b64b"),a("e3ab")),i=a("fef2"),s={name:"FormSelectorMulti",props:{},data:function(){return{formTableList:[],formTotal:0,selectedForms:[],queryParams:{deptId:void 0,pageNum:1,pageSize:10},formConf:{},formConfOpen:!1,formTitle:"",formQueryForm:{formName:""},categoryOptions:[]}},created:function(){this.getCategoryList(),this.getFormList()},methods:{getCategoryList:function(){var e=this;Object(i["h"])().then((function(t){return e.categoryOptions=t.rows}))},handleDetail:function(e){var t=this;this.formConfOpen=!0,this.formTitle="流程表单配置详细",this.formConf=JSON.parse(e.content),this.$nextTick((function(){t.$refs.vFormRef.setFormJson(t.formConf)}))},selectChange:function(e){if(e.length>1){var t=e.shift();this.$refs.formTable.toggleRowSelection(t,!1)}},getFormList:function(){var e=this,t=Object(n["a"])(Object(n["a"])({},this.formQueryForm),this.queryParams);Object(l["e"])(t).then((function(t){e.formTableList=t.rows,e.formTotal=t.total}))},handleFormSelectionChange:function(e){this.selectedForms=e},getFormRowKeys:function(e){return e.formId},getSelectedNodes:function(){return this.selectedForms},clearSelectionNode:function(){this.selectedForms=[],this.$refs.formTable.clearSelection()}}},c=s,u=a("2877"),p=Object(u["a"])(c,o,r,!1,null,null,null);t["a"]=p.exports},a4344:function(e,t,a){},bb8c:function(e,t,a){"use strict";a("6524")},ff87:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"process-viewer"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],ref:"processCanvas",staticClass:"process-canvas",staticStyle:{height:"100%"}}),a("defs",{ref:"customSuccessDefs"},[a("marker",{attrs:{id:"sequenceflow-end-white-success",viewBox:"0 0 20 20",refX:"11",refY:"10",markerWidth:"10",markerHeight:"10",orient:"auto"}},[a("path",{staticClass:"success-arrow",staticStyle:{"stroke-width":"1px","stroke-linecap":"round","stroke-dasharray":"10000, 1"},attrs:{d:"M 1 5 L 11 10 L 1 15 Z"}})]),a("marker",{attrs:{id:"conditional-flow-marker-white-success",viewBox:"0 0 20 20",refX:"-1",refY:"10",markerWidth:"10",markerHeight:"10",orient:"auto"}},[a("path",{staticClass:"success-conditional",staticStyle:{"stroke-width":"1px","stroke-linecap":"round","stroke-dasharray":"10000, 1"},attrs:{d:"M 0 10 L 8 6 L 16 10 L 8 14 Z"}})])]),a("defs",{ref:"customFailDefs"},[a("marker",{attrs:{id:"sequenceflow-end-white-fail",viewBox:"0 0 20 20",refX:"11",refY:"10",markerWidth:"10",markerHeight:"10",orient:"auto"}},[a("path",{staticClass:"fail-arrow",staticStyle:{"stroke-width":"1px","stroke-linecap":"round","stroke-dasharray":"10000, 1"},attrs:{d:"M 1 5 L 11 10 L 1 15 Z"}})]),a("marker",{attrs:{id:"conditional-flow-marker-white-fail",viewBox:"0 0 20 20",refX:"-1",refY:"10",markerWidth:"10",markerHeight:"10",orient:"auto"}},[a("path",{staticClass:"fail-conditional",staticStyle:{"stroke-width":"1px","stroke-linecap":"round","stroke-dasharray":"10000, 1"},attrs:{d:"M 0 10 L 8 6 L 16 10 L 8 14 Z"}})])]),a("el-dialog",{staticClass:"comment-dialog",attrs:{title:e.dlgTitle||"审批记录",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-row",[a("el-table",{attrs:{data:e.taskCommentList,size:"mini",border:"","header-cell-class-name":"table-header-gray"}},[a("el-table-column",{attrs:{label:"序号","header-align":"center",align:"center",type:"index",width:"55px"}}),a("el-table-column",{attrs:{label:"候选办理",prop:"candidate",width:"150px",align:"center"}}),a("el-table-column",{attrs:{label:"实际办理",prop:"assigneeName",width:"100px",align:"center"}}),a("el-table-column",{attrs:{label:"处理时间",prop:"createTime",width:"140px",align:"center"}}),a("el-table-column",{attrs:{label:"办结时间",prop:"finishTime",width:"140px",align:"center"}}),a("el-table-column",{attrs:{label:"耗时",prop:"duration",width:"100px",align:"center"}}),a("el-table-column",{attrs:{label:"审批意见",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.commentList&&t.row.commentList[0]?t.row.commentList[0].fullMessage:"")+" ")]}}])})],1)],1)],1),a("div",{staticStyle:{position:"absolute",top:"0px",left:"0px",width:"100%"}},[a("el-row",{attrs:{type:"flex",justify:"end"}},[a("el-button-group",{key:"scale-control",attrs:{size:"medium"}},[a("el-button",{attrs:{size:"medium",type:"default",plain:!0,disabled:e.defaultZoom<=.3,icon:"el-icon-zoom-out"},on:{click:function(t){return e.processZoomOut()}}}),a("el-button",{staticStyle:{width:"90px"},attrs:{size:"medium",type:"default"}},[e._v(e._s(Math.floor(10*this.defaultZoom*10)+"%"))]),a("el-button",{attrs:{size:"medium",type:"default",plain:!0,disabled:e.defaultZoom>=3.9,icon:"el-icon-zoom-in"},on:{click:function(t){return e.processZoomIn()}}}),a("el-button",{attrs:{size:"medium",type:"default",icon:"el-icon-c-scale-to-original"},on:{click:function(t){return e.processReZoom()}}}),e._t("default")],2)],1)],1)],1)},r=[],n=a("c7eb"),l=a("1da1"),i=(a("d9e2"),a("4de4"),a("caad"),a("b0c0"),a("d3b7"),a("2532"),a("0643"),a("2382"),a("4e3e"),a("159b"),a("7c3b"),a("88eb")),s=a("041f"),c={props:{xml:{type:String},finishedInfo:{type:Object},allCommentList:{type:Array}},data:function(){return{dialogVisible:!1,dlgTitle:void 0,defaultZoom:1,isLoading:!1,bpmnViewer:void 0,processNodeInfo:void 0,selectTaskId:void 0,taskCommentList:[],hoverTimer:null}},watch:{xml:{handler:function(e){this.importXML(e)},immediate:!0},finishedInfo:{handler:function(e){this.setProcessStatus(e)},immediate:!0}},created:function(){var e=this;this.$nextTick((function(){e.importXML(e.xml),e.setProcessStatus(e.finishedInfo)}))},methods:{processReZoom:function(){this.defaultZoom=1,this.bpmnViewer.get("canvas").zoom("fit-viewport","auto")},processZoomIn:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,t=Math.floor(100*this.defaultZoom+100*e)/100;if(t>4)throw new Error("[Process Designer Warn ]: The zoom ratio cannot be greater than 4");this.defaultZoom=t,this.bpmnViewer.get("canvas").zoom(this.defaultZoom)},processZoomOut:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,t=Math.floor(100*this.defaultZoom-100*e)/100;if(t<.2)throw new Error("[Process Designer Warn ]: The zoom ratio cannot be less than 0.2");this.defaultZoom=t,this.bpmnViewer.get("canvas").zoom(this.defaultZoom)},getOperationTagType:function(e){return"success"},clearViewer:function(){this.$refs.processCanvas&&(this.$refs.processCanvas.innerHTML=""),this.bpmnViewer&&this.bpmnViewer.destroy(),this.bpmnViewer=null},addCustomDefs:function(){var e=this.bpmnViewer.get("canvas"),t=e._svg,a=this.$refs.customSuccessDefs,o=this.$refs.customFailDefs;t.appendChild(a),t.appendChild(o)},onSelectElement:function(e){var t=this;this.selectTaskId=void 0,this.dlgTitle=void 0,null!=this.processNodeInfo&&null!=this.processNodeInfo.finishedTaskSet&&null!=e&&-1!==this.processNodeInfo.finishedTaskSet.indexOf(e.id)&&(this.selectTaskId=e.id,this.dlgTitle=e.businessObject?e.businessObject.name:void 0,this.taskCommentList=(this.allCommentList||[]).filter((function(e){return e.activityId===t.selectTaskId})),this.dialogVisible=!0)},importXML:function(e){var t=this;return Object(l["a"])(Object(n["a"])().mark((function a(){return Object(n["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.clearViewer(),null==e||""===e){a.next=18;break}return a.prev=2,t.bpmnViewer=new i["a"]({additionalModules:[s["a"]],container:t.$refs.processCanvas}),t.bpmnViewer.on("element.click",(function(e){var a=e.element;t.onSelectElement(a)})),t.isLoading=!0,a.next=8,t.bpmnViewer.importXML(e);case 8:t.addCustomDefs(),a.next=14;break;case 11:a.prev=11,a.t0=a["catch"](2),t.clearViewer();case 14:return a.prev=14,t.isLoading=!1,t.setProcessStatus(t.processNodeInfo),a.finish(14);case 18:case"end":return a.stop()}}),a,null,[[2,11,14,18]])})))()},setProcessStatus:function(e){if(this.processNodeInfo=e,!this.isLoading&&null!=this.processNodeInfo&&null!=this.bpmnViewer){var t=this.processNodeInfo,a=t.finishedTaskSet,o=t.rejectedTaskSet,r=t.unfinishedTaskSet,n=t.finishedSequenceFlowSet,l=this.bpmnViewer.get("canvas"),i=this.bpmnViewer.get("elementRegistry");Array.isArray(n)&&n.forEach((function(e){if(null!=e){l.addMarker(e,"success");var t=i.get(e),a=t.businessObject.conditionExpression;a&&l.addMarker(e,"condition-expression")}})),Array.isArray(a)&&a.forEach((function(e){return l.addMarker(e,"success")})),Array.isArray(r)&&r.forEach((function(e){return l.addMarker(e,"primary")})),Array.isArray(o)&&o.forEach((function(e){if(null!=e){var t=i.get(e);t.type.includes("Task")?l.addMarker(e,"danger"):l.addMarker(e,"warning")}}))}}},destroyed:function(){this.clearViewer()}},u=c,p=a("2877"),m=Object(p["a"])(u,o,r,!1,null,"1803e338",null);t["a"]=m.exports}}]);