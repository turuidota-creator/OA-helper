(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3dcdc690"],{"224d":function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));s("a630"),s("a15b"),s("d81d"),s("14d9"),s("d3b7"),s("3ca3"),s("2ca0"),s("498a"),s("0643"),s("4e3e"),s("a573"),s("159b");function r(e){e.$nextTick((function(){var t=e.$refs.formTabPane?e.$refs.formTabPane.$el:null;if(t){var s=e.$refs.formTabRecord?e.$refs.formTabRecord.$el:null;if(s){var r=document.createElement("iframe");r.style.position="absolute",r.style.top="-1000px",r.style.width="100%",r.style.height="100%",document.body.appendChild(r);var i=r.contentDocument||r.contentWindow.document,o=document.createElement("div"),n=t.cloneNode(!0),l=s.cloneNode(!0);"none"===l.style.display&&(l.style.display="block"),"hidden"===l.style.visibility&&(l.style.visibility="visible"),l.style.marginTop="20px",o.appendChild(n),o.appendChild(l),a(o);var _=o.querySelectorAll("button, .el-button");_.forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}));var c=o.querySelectorAll(".print-float-button");c.forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}));var d=document.querySelectorAll('style, link[rel="stylesheet"]'),u=Array.from(d).map((function(e){return e.outerHTML})).join("\n"),p="\n          <!DOCTYPE html>\n          <html>\n          <head>\n            <title></title>\n            ".concat(u,'\n            <style>\n              body {\n                font-family: "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", Arial, sans-serif;\n                font-size: 12px; /* 缩小字体 */\n                line-height: 1.3; /* 调整行高 */\n                color: #333;\n                margin: 0;\n                padding: 20px;\n                background: white;\n                word-wrap: break-word;\n                word-break: break-all;\n              }\n              .print-header {\n                text-align: center;\n                margin-bottom: 20px;\n                border-bottom: 2px solid #333;\n                padding-bottom: 10px;\n              }\n              .print-title {\n                font-size: 18px; /* 调整标题字体 */\n                font-weight: bold;\n              }\n              /* 隐藏表单元素 */\n              input, textarea, select, .el-input__inner, .el-textarea__inner {\n                display: none !important;\n              }\n              /* 显示表单值的文本 */\n              .form-value {\n                display: inline-block !important;\n                min-height: 18px; /* 调整高度 */\n                padding: 3px 0; /* 调整内边距 */\n              }\n              .el-checkbox__input, .el-radio__input, .el-switch, .el-slider {\n                display: none !important;\n              }\n              .el-checkbox__label, .el-radio__label {\n                font-weight: normal !important;\n              }\n              /* 隐藏各种图标 */\n              .el-input__icon, .el-icon-arrow-up, .el-icon-arrow-down, .el-icon-circle-close,\n              .el-icon-circle-check, .el-input__suffix, .el-input__prefix, .el-input__clear,\n              .el-form-item__content i, .el-select__caret, .el-select__icon {\n                display: none !important;\n              }\n              /* 隐藏按钮 */\n              .el-button, button {\n                display: none !important;\n              }\n              /* 调整卡片样式 */\n              .el-card {\n                margin-bottom: 15px; /* 减小间距 */\n                font-size: 12px; /* 统一字体大小 */\n              }\n              .el-card__header {\n                padding: 8px 15px; /* 调整内边距 */\n                font-size: 13px; /* 标题字体 */\n              }\n              .el-card__body {\n                padding: 15px; /* 调整内边距 */\n              }\n              /* 表单元素样式调整 */\n              .el-form-item {\n                margin-bottom: 12px; /* 减小间距 */\n              }\n              .el-form-item__label {\n                font-size: 12px; /* 标签字体大小 */\n                padding: 0 8px 0 0; /* 调整标签内边距 */\n                line-height: 1.3; /* 调整行高 */\n              }\n              .el-form-item__content {\n                font-size: 12px; /* 内容字体大小 */\n                line-height: 1.3; /* 调整行高 */\n              }\n              /* 表格相关样式调整 */\n              .el-table .el-table__cell {\n                padding: 5px 0; /* 调整表格内边距 */\n                font-size: 11px; /* 表格字体 */\n              }\n              /* 调整列宽，避免换行 */\n              .el-col-24 {\n                width: 100%;\n              }\n              .el-col-offset-2 {\n                margin-left: 8.33333%;\n              }\n              .el-col-20 {\n                width: 83.33333%;\n              }\n              /* 文本换行 */\n              .el-form-item__content,\n              .el-form-item__label {\n                white-space: pre-wrap;\n                line-height: 1.5 !important;;\n              }\n              @media print {\n                body {\n                  -webkit-print-color-adjust: exact;\n                  print-color-adjust: exact;\n                }\n                /* 打印时进一步优化 */\n                * {\n                  font-size: 11px !important; /* 打印时使用更小字体 */\n                }\n                .el-form-item__label,\n                .el-form-item__content {\n                  font-size: 11px !important;\n                }\n              }\n              @page {\n                margin: 1cm;\n              }\n            </style>\n          </head>\n          <body>\n            <div class="print-header">\n              <div class="print-title">表单信息</div>\n            </div>\n            <div class="print-content">\n            </div>\n          </body>\n          </html>\n        ');i.open(),i.write(p),i.querySelector(".print-content").appendChild(o),i.close(),setTimeout((function(){try{r.contentWindow.focus(),r.contentWindow.print()}catch(e){console.error("打印出错:",e)}finally{setTimeout((function(){document.body.contains(r)&&document.body.removeChild(r)}),1e3)}}),500)}else e.$message.error("无法获取流转记录内容")}else e.$message.error("无法获取表单信息内容")}))}function a(e){var t=e.querySelectorAll('input:not([type="checkbox"]):not([type="radio"])');t.forEach((function(e){var t=e.value||"",s=document.createTextNode(t),r=document.createElement("span");r.className="form-value",r.appendChild(s),e.parentNode.replaceChild(r,e)}));var s=e.querySelectorAll("textarea");s.forEach((function(e){var t=e.value||"",s=document.createTextNode(t),r=document.createElement("span");r.className="form-value",r.appendChild(s),e.parentNode.replaceChild(r,e)}));var r=e.querySelectorAll("select");r.forEach((function(e){var t=e.options[e.selectedIndex],s=t?t.text:"",r=document.createTextNode(s),a=document.createElement("span");a.className="form-value",a.appendChild(r),e.parentNode.replaceChild(a,e)}));var a=e.querySelectorAll(".el-checkbox");a.forEach((function(e){var t=e.querySelector('input[type="checkbox"]'),s=e.querySelector(".el-checkbox__label");if(t&&s){var r=t.checked,a=s.textContent||"";if(a.startsWith("注：")||a.startsWith("（注："))s.textContent="";else{var i=r?"✓ "+a:"○ "+a;s.textContent=i}t.parentNode&&t.parentNode.removeChild(t)}}));var i=e.querySelectorAll(".el-radio");i.forEach((function(e){var t=e.querySelector('input[type="radio"]'),s=e.querySelector(".el-radio__label");if(t&&s){var r=t.checked,a=s.textContent||"";if(a.startsWith("注：")||a.startsWith("（注："))s.textContent="";else{var i=r?"◉ "+a:"○ "+a;s.textContent=i}t.parentNode&&t.parentNode.removeChild(t)}}));var o=e.querySelectorAll(".el-switch");o.forEach((function(e){var t=e.classList.contains("is-checked"),s=document.createTextNode(t?"开启":"关闭"),r=document.createElement("span");r.className="form-value",r.appendChild(s),e.parentNode.replaceChild(r,e)}));var n=e.querySelectorAll(".el-input-group");n.forEach((function(e){var t=e.querySelector(".el-input-group__append"),s=e.querySelector(".el-input-group__prepend");t&&(t.style.display="none"),s&&(s.style.display="none")}));var l=e.querySelectorAll(".el-form-item:not(.sub-form-item):not(.sub-form-table-column .el-form-item)");l.forEach((function(e){var t=e.querySelector(".el-form-item__label"),s=e.querySelector(".el-form-item__content");if(t&&s){var r=document.createElement("table");r.style.width="100%",r.style.borderCollapse="collapse",r.style.marginBottom="10px";var a=document.createElement("tbody"),i=document.createElement("tr"),o=document.createElement("td");o.style.width="150px",o.style.fontWeight="bold",o.style.padding="8px",o.style.border="1px solid #ddd",o.style.verticalAlign="top",o.style.backgroundColor="#f9f9f9",o.textContent=t.textContent;var n=document.createElement("td");n.style.padding="8px",n.style.border="1px solid #ddd",n.style.verticalAlign="top";var l=s.querySelectorAll("input, textarea, select");l.forEach((function(e){var t=e.value||"",s=document.createTextNode(t),r=document.createElement("span");r.className="form-value",r.appendChild(s),e.parentNode.replaceChild(r,e)}));var _=s.querySelectorAll(".el-checkbox");_.forEach((function(e){var t=e.querySelector('input[type="checkbox"]'),s=e.querySelector(".el-checkbox__label");if(t&&s){var r=t.checked,a=s.textContent||"";s.textContent=r?"✓ "+a:"○ "+a,t.parentNode.removeChild(t)}}));var c=s.querySelectorAll(".el-radio");c.forEach((function(e){var t=e.querySelector('input[type="radio"]'),s=e.querySelector(".el-radio__label");if(t&&s){var r=t.checked,a=s.textContent||"";s.textContent=r?"◉ "+a:"○ "+a,t.parentNode.removeChild(t)}}));while(s.firstChild)n.appendChild(s.firstChild);i.appendChild(o),i.appendChild(n),a.appendChild(i),r.appendChild(a),e.parentNode.replaceChild(r,e)}}));var _=e.querySelectorAll(".el-input__prefix, .el-input__suffix, .el-form-item__label-wrap");_.forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}));var c=e.querySelectorAll(".el-form-item__label");c.forEach((function(e){var t=e.querySelectorAll(".el-icon, i");t.forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))}));var d,u=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:function(e){var t=e.textContent.trim();return t.startsWith("注：")||t.startsWith("（注：")?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),p=[];while(d=u.nextNode())p.push(d);p.forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))}},"30ff":function(e,t,s){"use strict";s.d(t,"b",(function(){return a})),s.d(t,"a",(function(){return i})),s.d(t,"c",(function(){return o})),s.d(t,"d",(function(){return n}));var r=s("b775");function a(e){return Object(r["a"])({url:"/flowable/opinionRecord/list",method:"get",params:e})}function i(e){return Object(r["a"])({url:"/flowable/opinionRecord/"+e,method:"get"})}function o(e){return Object(r["a"])({url:"/flowable/opinionRecord/forward",method:"post",data:e})}function n(e){return Object(r["a"])({url:"/flowable/opinionRecord/update",method:"post",data:e})}},"3f61":function(e,t,s){},"583d":function(e,t,s){"use strict";var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container"},[s("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[s("el-row",[s("el-col",{attrs:{span:24}},[s("el-form",{ref:"taskForm",attrs:{model:e.taskForm,rules:e.rules,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"审批意见",prop:"comment"}},[s("div",{staticStyle:{border:"1px solid #ccc"}},[s("Toolbar",{staticStyle:{"border-bottom":"1px solid #ccc"},attrs:{editor:e.wangeditor,defaultConfig:e.toolbarConfig,mode:"simple"}}),s("Editor",{staticStyle:{height:"200px","overflow-y":"hidden"},attrs:{defaultConfig:e.editorConfig,mode:"simple"},on:{onCreated:e.wangeditorOnCreated},model:{value:e.taskForm.comment,callback:function(t){e.$set(e.taskForm,"comment",t)},expression:"taskForm.comment"}})],1)]),"forward"===e.dialogType||"transfer"===e.dialogType?s("el-form-item",{attrs:{label:"接收人",prop:"assigneeIds"}},[e._l(e.assigneeUsers,(function(t,r){return s("el-tag",{key:t.userId,attrs:{closable:"","disable-transitions":!1},on:{close:function(s){return e.handleClose(t)}}},[e._v(" "+e._s(t.nickName)+" ")])})),s("el-button",{staticClass:"button-new-tag",attrs:{type:"primary",icon:"el-icon-plus",size:"mini",circle:""},on:{click:function(t){e.userOpen=!0}}})],2):e._e(),"forward"===e.dialogType||"note"===e.dialogType?s("el-form-item",{attrs:{label:"文件上传",prop:"fileList"}},[s("el-upload",{staticClass:"upload-demo",attrs:{action:"/cyouNeiOaServer/system/file/upload",headers:e.headers,"on-success":e.handleSuccess,"on-preview":e.handlePreview,"before-remove":e.beforeRemove,multiple:"",limit:3,"on-exceed":e.handleExceed,"file-list":e.fileList}},[s("i",{staticClass:"el-icon-plus",attrs:{slot:"trigger"},slot:"trigger"}),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("上传文件不能超过30MB")])])],1):e._e()],1)],1)],1),s("br"),s("el-row",{staticClass:"apply-row",attrs:{gutter:10,type:"flex",justify:"center"}},[s("el-col",{attrs:{span:1.5}},[s("el-button",{attrs:{icon:"el-icon-circle-check",type:"primary"},on:{click:function(t){return e.handleComplete("taskForm")}}},[e._v("提交")])],1),s("el-col",{attrs:{span:1.5}},[s("el-button",{attrs:{icon:"el-icon-close",type:"default"},on:{click:e.handleCancel}},[e._v("取消")])],1)],1)],1),s("el-dialog",{attrs:{title:"选择接收人",visible:e.userOpen,width:"60%","append-to-body":""},on:{"update:visible":function(t){e.userOpen=t}}},[s("PersonSelector",{ref:"personSelector",attrs:{isSingle:"transfer"===e.dialogType}}),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.handleUserComplete}},[e._v("确 定")]),s("el-button",{on:{click:function(t){e.userOpen=!1}}},[e._v("取 消")])],1)],1)],1)},a=[],i=(s("99af"),s("7db0"),s("caad"),s("a15b"),s("d81d"),s("14d9"),s("a434"),s("af93"),s("d3b7"),s("2532"),s("0643"),s("fffc"),s("4e3e"),s("a573"),s("159b"),s("4e15")),o=(s("560e"),s("5f87")),n=s("30ff"),l=s("9a9d"),_={name:"ForwardView",components:{Editor:i["a"],Toolbar:i["b"]},props:{procInsId:{type:String,required:!0},taskId:{type:String},recordId:{type:String},dialogType:{type:String},show:{type:Boolean,default:!1}},data:function(){return{headers:{Authorization:"Bearer "+Object(o["a"])()},wangeditor:null,toolbarConfig:{excludeKeys:["fullScreen","insertVideo","insertImage"]},editorConfig:{readOnly:!1,placeholder:"请输入意见",MENU_CONF:{}},rules:{assigneeIds:[{required:!0,message:"接收人不能为空",trigger:"submit"}]},taskForm:{processInstanceId:"",taskId:"",assigneeIds:[],comment:""},assigneeUsers:[],userOpen:!1,fileList:[]}},watch:{"taskForm.assigneeIds":function(e){var t=this;e&&this.$nextTick((function(){t.$refs.taskForm.clearValidate("assigneeIds")}))}},created:function(){console.log("转发任务弹窗初始化 procInsId: "+this.procInsId+"  taskId: "+this.taskId),this.taskForm.processInstanceId=this.procInsId,this.taskForm.taskId=this.taskId,this.wangEditorConfig()},methods:{wangeditorOnCreated:function(e){this.wangeditor=Object.seal(e)},wangEditorConfig:function(){this.editorConfig.MENU_CONF["uploadImage"]={server:"/cyouNeiOaServer/system/file/upload",fieldName:"file",headers:{Authorization:"Bearer "+Object(o["a"])()},meta:{key:"wangeditor-filename"},customInsert:function(e,t){t(e.data.filePath,e.data.fileName,"")}}},handleUserComplete:function(){var e=this,t=this.$refs.personSelector.getSelectedNodes();if(!t||t.length<=0)this.$modal.msgError("请选择用户");else{if(console.log(t,"selectedUserDate"),console.log(this.$refs.personSelector.isSingle,"this.$refs.personSelector.isSingle"),this.$refs.personSelector.isSingle)this.assigneeUsers[0]=t;else{var s=this.assigneeUsers.map((function(e){return e.userId}))||[];t.forEach((function(t,r){s.includes(t.userId)||e.assigneeUsers.push(t)}))}this.taskForm.assigneeIds=this.assigneeUsers.map((function(e){return e.userId}))||[],this.userOpen=!1}},handleClose:function(e){var t=this.assigneeUsers.find((function(t){return t.userId===e.userId}));if(this.assigneeUsers.splice(this.assigneeUsers.indexOf(t),1),this.assigneeUsers&&this.assigneeUsers.length>0){var s=this.assigneeUsers.map((function(e){return e.userId}))||[];this.taskForm.assigneeIds=s}else this.taskForm.assigneeIds=[]},handleComplete:function(e){var t=this,s=this.procInsId,r=this.taskId,a=this.taskForm.assigneeIds,i=this.fileList.map((function(e){return e.response.data.fileName}))||[],o=this.fileList.map((function(e){return e.response.data.filePath}))||[];if("forward"===this.dialogType)this.$refs[e].validate((function(e){if(e){var l=t.taskForm.comment,_={processInstanceId:s,taskId:r,assigneeIds:a,commentText:l},c=i.join(","),d=o.join(",");c.length>0&&d.length>0&&(_.attachmentNames=c,_.attachmentUrls=d),Object(n["c"])(_).then((function(e){t.$modal.msgSuccess(e.msg),t.handleCancel()}))}}));else if("note"===this.dialogType){var _=this.recordId,c=this.taskForm.comment,d={recordId:_,assigneeComment:c},u=i.join(","),p=o.join(",");u.length>0&&p.length>0&&(d.assigneeFileNames=u,d.assigneeFileUrls=p),Object(n["d"])(d).then((function(e){t.$modal.msgSuccess(e.msg),t.closePageToParent()}))}else"transfer"===this.dialogType&&this.$refs[e].validate((function(e){if(e){var s=t.taskForm.comment,i=a[0],o={taskId:r,userId:i,comment:s};Object(l["i"])(o).then((function(e){t.$modal.msgSuccess(e.msg),t.closePageToParent()}))}}))},handleCancel:function(){this.$emit("update:show",!1)},closePageToParent:function(){this.$emit("back-home")},handleSuccess:function(e,t,s){this.fileList=s},handlePreview:function(e){var t=e.response.data.filePath;window.open(t,"_blank")},handleExceed:function(e,t){this.$message.warning("当前限制选择 3 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},beforeRemove:function(e,t){this.fileList.splice(this.fileList.indexOf(e),1)}}},c=_,d=(s("5e68"),s("2877")),u=Object(d["a"])(c,r,a,!1,null,"30fb7614",null);t["a"]=u.exports},"5e68":function(e,t,s){"use strict";s("ccdc")},"7aee":function(e,t,s){"use strict";s.d(t,"d",(function(){return a})),s.d(t,"c",(function(){return i})),s.d(t,"a",(function(){return o})),s.d(t,"e",(function(){return n})),s.d(t,"b",(function(){return l}));var r=s("b775");function a(e){return Object(r["a"])({url:"/system/customDict/list",method:"get",params:e})}function i(e){return Object(r["a"])({url:"/system/customDict/"+e,method:"get"})}function o(e){return Object(r["a"])({url:"/system/customDict",method:"post",data:e})}function n(e){return Object(r["a"])({url:"/system/customDict",method:"put",data:e})}function l(e){return Object(r["a"])({url:"/system/customDict/"+e,method:"delete"})}},"7c3b":function(e,t,s){},"88b5":function(e,t,s){"use strict";var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Editor",{staticStyle:{"overflow-y":"hidden"},attrs:{defaultConfig:e.editorConfig,mode:e.mode},on:{onCreated:e.handleCreated},model:{value:e.valueHtml,callback:function(t){e.valueHtml=t},expression:"valueHtml"}})],1)},a=[],i=(s("560e"),s("4e15")),o={name:"WangRichText",components:{Editor:i["a"],Toolbar:i["b"]},props:{details:{type:String,default:""}},data:function(){return{editor:null,mode:"simple",valueHtml:this.details,editorConfig:{readOnly:!0}}},watch:{details:function(e){e!==this.valueHtml&&(this.valueHtml=e)}},methods:{handleCreated:function(e){this.editor=e}},beforeDestroy:function(){null!=this.editor&&this.editor.destroy()}},n=o,l=s("2877"),_=Object(l["a"])(n,r,a,!1,null,null,null);t["a"]=_.exports},9299:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}],staticClass:"app-container"},[r("div",{staticClass:"fixed-tabs"},[r("el-tabs",{attrs:{"tab-position":"top",value:"approval"},on:{"tab-click":e.handleTabClick}},[r("el-tab-pane",{ref:"formTabPane",attrs:{label:"任务办理",name:"approval"}},[r("div",{staticClass:"form-view-ui"},[r("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("申请人基础信息")])]),r("el-col",{attrs:{span:24}},[e.user?r("el-form",{attrs:{"label-width":"80px"}},[r("el-row",{attrs:{gutter:24}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"姓名","label-width":"40%","label-position":"left"}},[e._v(" "+e._s(e.user.nickName)+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"工号","label-width":"40%","label-position":"left"}},[e._v(" "+e._s(e.user.empNo)+" ")])],1)],1),r("el-row",{attrs:{gutter:24}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"用户邮箱","label-width":"40%","label-position":"left"}},[e._v(" "+e._s(e.user.email)+" ")])],1),r("el-col",{attrs:{span:12}},[e.showUserDeptInfo?r("el-form-item",{attrs:{label:"所属部门","label-width":"40%","label-position":"left"}},[e._v(" "+e._s(e.user&&e.user.dept?e.user.dept.deptFullName:"")+" ")]):e._e()],1)],1),r("el-row",{attrs:{gutter:24}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"岗位","label-width":"40%","label-position":"left"}},[e._v(" "+e._s(e.user.postGroup)+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"流程编号","label-width":"40%","label-position":"left"}},[e._v(" "+e._s(e.processCode)+" ")])],1)],1)],1):e._e()],1)],1),e.taskStartFlag?e._e():r("div",e._l(e.processFormList,(function(t,s){return r("el-card",{key:s,staticClass:"box-card",attrs:{shadow:"never"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v(e._s(t.title))])]),r("el-col",{attrs:{span:24}},[r("v-form-render",{ref:"vFormRefDetail",refInFor:!0,attrs:{"form-json":t,"form-data":e.formData}})],1)],1)})),1)],1),!0===e.isRunning&&e.isTodoPerson?r("div",{staticClass:"form-edit-ui"},[e.taskFormOpen?r("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("填写表单")])]),r("el-col",{attrs:{span:24}},[r("v-form-render",{ref:"vFormRef",attrs:{"form-json":e.taskFormData,"form-data":e.formData}})],1)],1):e._e(),e.taskAuditFlag?r("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("审批流程")])]),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form",{ref:"taskForm",attrs:{model:e.taskForm,rules:e.rules,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"审批意见",prop:"comment"}},[r("div",{staticStyle:{border:"1px solid #ccc"}},[r("Toolbar",{staticStyle:{"border-bottom":"1px solid #ccc"},attrs:{editor:e.wangeditor,defaultConfig:e.toolbarConfig,mode:"simple"}}),r("Editor",{staticStyle:{height:"200px","overflow-y":"hidden"},attrs:{defaultConfig:e.editorConfig,mode:"simple"},on:{onCreated:e.wangeditorOnCreated},model:{value:e.taskForm.comment,callback:function(t){e.$set(e.taskForm,"comment",t)},expression:"taskForm.comment"}})],1)]),e.hideTransferButtons?e._e():r("el-form-item",{attrs:{label:"抄送人",prop:"copyUserIds"}},[e._l(e.copyUser,(function(t,s){return r("el-tag",{key:s,attrs:{closable:"","disable-transitions":!1},on:{close:function(s){return e.handleClose("copy",t)}}},[e._v(" "+e._s(t.nickName)+" ")])})),r("el-button",{staticClass:"button-new-tag",attrs:{type:"primary",icon:"el-icon-plus",size:"mini",circle:""},on:{click:e.onSelectCopyUsers}})],2),r("el-form-item",{attrs:{label:"文件上传",prop:"fileList"}},[r("el-upload",{staticClass:"upload-demo",attrs:{action:"/cyouNeiOaServer/system/file/upload",headers:e.headers,"on-success":e.handleSuccess,"on-preview":e.handlePreview,"before-remove":e.beforeRemove,"before-upload":e.beforeUpload,multiple:"",limit:30,"on-exceed":e.handleExceed,"file-list":e.fileList}},[r("i",{staticClass:"el-icon-plus",attrs:{slot:"trigger"},slot:"trigger"}),r("div",{staticClass:"el-upload__tip",staticStyle:{color:"red"},attrs:{slot:"tip"},slot:"tip"},[e._v("上传文件不能超过30MB")])])],1)],1)],1)],1),r("br"),r("el-row",{staticClass:"apply-row",attrs:{gutter:10,type:"flex",justify:"center"}},[r("el-col",{attrs:{span:1.5}},[r("el-button",{attrs:{icon:"el-icon-circle-check",type:"success"},on:{click:e.handleComplete}},[e._v("通过")])],1),e.isStartNode||e.hideTransferButtons?e._e():r("el-col",{attrs:{span:1.5}},[r("el-button",{attrs:{icon:"el-icon-thumb",type:"success"},on:{click:e.handleTransfer}},[e._v("转办")])],1),e.isStartNode?e._e():r("el-col",{attrs:{span:1.5}},[r("el-button",{attrs:{icon:"el-icon-refresh-left",type:"warning"},on:{click:e.handleReturn}},[e._v("退回")])],1)],1)],1):e._e()],1):e._e(),r("div",{staticClass:"process-history-container",staticStyle:{display:"none"}},[r("el-row",{staticClass:"header-row",attrs:{gutter:20}},[r("el-col",{staticClass:"header-cell",attrs:{span:5}},[e._v("节点")]),r("el-col",{staticClass:"header-cell",attrs:{span:12}},[e._v("意见")]),r("el-col",{staticClass:"header-cell",attrs:{span:2}},[e._v("操作")]),r("el-col",{staticClass:"header-cell",attrs:{span:5}},[e._v("接收人")])],1),e._l(e.processNodeHistory,(function(t,s){return r("el-row",{key:s,staticClass:"data-row",class:{"stripe-row":s%2===1},attrs:{gutter:20}},[r("el-col",{staticClass:"data-cell",attrs:{span:5}},[r("div",{staticClass:"cell-content"},["endEvent"===t.activityType?r("span",[e._v("结束流程")]):e._e(),"userTask"===t.activityType?r("span",[e._v(e._s(t.activityName))]):e._e()])]),r("el-col",{staticClass:"data-cell",attrs:{span:12}},[r("div",{staticClass:"cell-content"},[t.commentList&&t.commentList.length>0?r("div",e._l(t.commentList,(function(t,s){return r("div",{key:s},[1==t.type?r("WangRichText",{attrs:{details:t.fullMessage}}):e._e()],1)})),0):e._e(),t.fileList&&t.fileList.length>0?r("div",e._l(t.fileList,(function(t,s){return r("div",{key:s},[null!=t?r("el-divider"):e._e(),null!=t?r("span",[r("a",{attrs:{title:"点击查看",href:t.filePath,target:"_blank"}},[e._v(e._s(t.fileName))])]):e._e()],1)})),0):e._e(),r("div",{staticStyle:{"text-align":"right"}},[e._v(e._s(t.assigneeName))]),r("div",{staticStyle:{"text-align":"right"}},[e._v(e._s(t.endTime||"")+" （耗时 "+e._s(t.duration)+"）")])])]),r("el-col",{staticClass:"data-cell",attrs:{span:2}},[r("div",{staticClass:"cell-content"},[t.optType?r("el-tag",{attrs:{type:e.approveTypeTag(t.optType),size:"mini"}},[e._v(" "+e._s(e.commentType(t.optType))+" ")]):e._e()],1)]),r("el-col",{staticClass:"data-cell",attrs:{span:5}},[r("div",{staticClass:"cell-content"},[e.showFlags[s]?e._e():r("a",{staticStyle:{color:"blue"},on:{click:function(t){return e.handleShow(s)}}},[e._v(" 展示 ")]),e.showFlags[s]&&t.receiver?r("WangRichText",{attrs:{details:t.receiver}}):e._e()],1)])],1)}))],2)]),r("el-tab-pane",{ref:"formTabRecord",attrs:{label:"流转记录",name:"record"}},[r("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[r("el-col",{attrs:{span:24}},[r("div",{staticClass:"block"},[r("el-timeline",e._l(e.historyProcNodeList,(function(t,s){return r("el-timeline-item",{key:s,attrs:{icon:e.setIcon(t.endTime),color:e.setColor(t.endTime)}},[r("p",{staticStyle:{"font-weight":"700"}},[e._v(e._s(t.activityName))]),"startEvent"===t.activityType?r("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[e._v(" "+e._s(t.assigneeName)+" 在 "+e._s(t.createTime)+" 发起流程 ")]):e._e(),"userTask"===t.activityType?r("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[r("el-descriptions",{attrs:{column:5,labelStyle:{"font-weight":"bold"}}},[r("el-descriptions-item",{attrs:{label:"实际办理"}},[e._v(e._s(t.assigneeName||"-"))]),null==t.candidateList?r("el-descriptions-item",{attrs:{label:"候选办理"}},[e._v(e._s(t.candidate||"-"))]):e._e(),null!=t.candidateList?r("el-descriptions-item",{attrs:{label:"候选办理"}},e._l(t.candidateList,(function(t){return r("el-popover",{key:t.id,attrs:{placement:"top-start",title:t.roleName,width:"200",trigger:"hover",content:t.nickNames}},[r("el-button",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(t.roleName))])],1)})),1):e._e(),r("el-descriptions-item",{attrs:{label:"接收时间"}},[e._v(e._s(t.createTime||"-"))]),r("el-descriptions-item",{attrs:{label:"办结时间"}},[e._v(e._s(t.endTime||"-"))]),r("el-descriptions-item",{attrs:{label:"耗时"}},[e._v(e._s(t.duration||"-"))]),t.agentList&&t.agentList.length>0?r("el-descriptions-item",{attrs:{label:"代理"}},[e._v(e._s(t.agentList.join("，")))]):e._e()],1),t.commentList&&t.commentList.length>0?r("div",e._l(t.commentList,(function(t,s){return r("div",{key:s},[r("el-divider",{attrs:{"content-position":"left"}},[r("el-tag",{attrs:{type:e.approveTypeTag(t.type),size:"mini"}},[e._v(e._s(e.commentType(t.type)))]),r("el-tag",{attrs:{type:"info",effect:"plain",size:"mini"}},[e._v(e._s(t.time))])],1),r("WangRichText",{attrs:{details:t.fullMessage}})],1)})),0):e._e(),t.copyList&&t.copyList.length>0?r("div",[r("el-divider",{attrs:{"content-position":"left"}},[r("el-tag",{attrs:{type:"info",effect:"plain",size:"mini"}},[e._v("抄送人")])],1),e._l(t.copyList,(function(t,s){return r("div",{key:s},[r("span",[e._v(e._s(t.originatorName))]),r("span",[e._v(" -> ")]),r("span",[e._v(e._s(t.nickName)+" ")]),r("el-tag",{attrs:{type:"info",effect:"plain",size:"mini"}},[e._v(e._s(t.createTime))])],1)}))],2):e._e(),t.opinionList&&t.opinionList.length>0?r("div",e._l(t.opinionList,(function(t,s){return r("div",{key:t.recordId},[r("el-divider",{attrs:{"content-position":"left"}},[r("el-tag",{attrs:{type:e.approveTypeTag("4"),size:"mini"}},[e._v(e._s(e.commentType("4")))]),r("el-tag",{attrs:{type:"info",effect:"plain",size:"mini"}},[e._v(e._s(t.createTime))])],1),r("span",[e._v(e._s(t.operatorName))]),r("span",[e._v(" -> ")]),r("span",[e._v(e._s(t.assigneeName)+" ")]),r("WangRichText",{staticClass:"forward-comment",attrs:{details:t.commentText}}),t.fileList&&t.fileList.length>0?e._l(t.fileList,(function(t,s){return r("div",[null!=t.fileName?r("span",[r("a",{staticClass:"el-link el-link--primary comment-file",attrs:{title:"点击查看",href:t.fileUrl,target:"_blank"}},[e._v(e._s(t.fileName))])]):e._e()])})):e._e(),"completed"===t.recordStatus?r("div",{staticStyle:{"padding-top":"10px"}},[r("span",[e._v(e._s(t.assigneeName)+" ：")]),r("el-tag",{attrs:{type:"info",effect:"plain",size:"mini"}},[e._v(e._s(t.endTime))]),r("WangRichText",{staticClass:"forward-comment",attrs:{details:t.assigneeComment}}),t.assigneeFileList&&t.assigneeFileList.length>0?e._l(t.assigneeFileList,(function(t,s){return r("div",[null!=t.fileName?r("span",[r("a",{staticClass:"el-link el-link--primary comment-file",attrs:{title:"点击查看",href:t.fileUrl,target:"_blank"}},[e._v(e._s(t.fileName))])]):e._e()])})):e._e()],2):e._e()],2)})),0):e._e(),t.fileList&&t.fileList.length>0?r("div",e._l(t.fileList,(function(t,s){return r("div",{key:s},[null!=t?r("el-divider"):e._e(),null!=t?r("span",[r("a",{attrs:{title:"点击查看",href:t.filePath,target:"_blank"}},[e._v(e._s(t.fileName))])]):e._e()],1)})),0):e._e()],1):e._e(),"endEvent"===t.activityType?r("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[e._v(" "+e._s(t.createTime)+" 结束流程 ")]):e._e()],1)})),1)],1)])],1),r("el-card",{staticClass:"process-invoice-img"},e._l(e.invoiceImgUrls,(function(e,t){return r("img",{key:t,staticStyle:{width:"100%","max-width":"200mm",height:"auto","page-break-inside":"avoid"},attrs:{src:e}})})),0)],1),r("el-tab-pane",{attrs:{label:"流程跟踪",name:"track"}},[r("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[r("process-viewer",{key:"designer-"+e.loadIndex,style:"height:"+e.height,attrs:{xml:e.xmlData,finishedInfo:e.finishedInfo,allCommentList:e.historyProcNodeList}})],1)],1),r("el-tab-pane",{attrs:{label:"相关附件",name:"attachment"}},[r("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("附件列表")]),r("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.downloadAllAttachments}},[e._v("全部下载")])],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.allAttachments}},[r("el-table-column",{attrs:{prop:"fileName",label:"文件名","min-width":"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{color:"#123885",cursor:"pointer"},on:{click:function(s){return e.downloadFile(t.row)}}},[e._v(e._s(t.row.fileName))])]}}])}),r("el-table-column",{attrs:{prop:"uploader",label:"上传人"}}),r("el-table-column",{attrs:{prop:"uploadTime",label:"上传时间"}}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text"},on:{click:function(s){return e.downloadFile(t.row)}}},[e._v("下载")])]}}])})],1)],1)],1)],1)],1),r("div",{directives:[{name:"show",rawName:"v-show",value:"approval"===e.activeTabName,expression:"activeTabName === 'approval'"}],staticClass:"print-float-button",on:{click:e.printFormInfo}},[r("el-tooltip",{attrs:{effect:"dark",content:"打印表单信息",placement:"left"}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-printer",circle:"",size:"medium"}})],1)],1),!e.hideTransferButtons&&e.showForward?[r("div",{directives:[{name:"show",rawName:"v-show",value:"approval"===e.activeTabName,expression:"activeTabName === 'approval'"}],staticClass:"forward-float-button",on:{click:e.showForwardDialog}},[r("el-tooltip",{attrs:{effect:"dark",content:"转发",placement:"left"}},[r("div",{staticClass:"circle-btn"},[e._v("转发")])])],1)]:e._e(),e.showNote?[r("div",{directives:[{name:"show",rawName:"v-show",value:"approval"===e.activeTabName,expression:"activeTabName === 'approval'"}],staticClass:"note-float-button",attrs:{id:"noteButton"},on:{click:e.showNoteDialog}},[r("el-tooltip",{attrs:{effect:"dark",content:"填写批注",placement:"left"}},[r("div",{staticClass:"circle-btn"},[e._v("批注")])])],1)]:e._e(),r("el-dialog",{attrs:{title:e.returnTitle,visible:e.returnOpen,width:"40%","append-to-body":""},on:{"update:visible":function(t){e.returnOpen=t}}},[r("el-form",{ref:"taskForm",attrs:{model:e.taskForm,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"退回节点",prop:"targetKey"}},[r("el-radio-group",{model:{value:e.taskForm.targetKey,callback:function(t){e.$set(e.taskForm,"targetKey",t)},expression:"taskForm.targetKey"}},e._l(e.returnTaskList,(function(t){return r("el-radio-button",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:e.submitReturn}},[e._v("确 定")]),r("el-button",{on:{click:function(t){e.returnOpen=!1}}},[e._v("取 消")])],1)],1),e.userData.open?r("el-dialog",{attrs:{title:e.userData.title,visible:e.userData.open,width:"70vw","append-to-body":""},on:{"update:visible":function(t){return e.$set(e.userData,"open",t)}}},[r("div",{staticClass:"person-selector-container"},[r("el-tabs",{staticStyle:{height:"300px",width:"100%"},attrs:{type:"card"},on:{"tab-click":e.handleUserTabClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"按组织结构",name:"1"}},[r("div",{staticStyle:{width:"100%"}},[r("el-input",{staticStyle:{"margin-bottom":"10px"},attrs:{placeholder:"请输入部门名称",clearable:"",size:"small","prefix-icon":"el-icon-search"},model:{value:e.deptName,callback:function(t){e.deptName=t},expression:"deptName"}}),r("el-tree",{ref:"deptTree",staticClass:"down-tree",staticStyle:{height:"200px"},attrs:{data:e.deptOptions,props:e.deptProps,"expand-on-click-node":!1,"filter-node-method":e.filterDeptNode},on:{"node-click":e.handleDeptNodeClick}})],1)]),r("el-tab-pane",{attrs:{label:"组合查询",name:"3"}},[r("div",{staticStyle:{display:"flex","flex-direction":"column"}},[r("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center","padding-bottom":"15px"}},[r("div",{staticStyle:{"padding-right":"100px"}},[e._v("姓名")]),r("el-input",{staticStyle:{width:"300px"},attrs:{size:"small"},on:{blur:e.getUserList,change:e.getUserList},model:{value:e.queryParams.nickName,callback:function(t){e.$set(e.queryParams,"nickName",t)},expression:"queryParams.nickName"}})],1),r("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center","padding-bottom":"15px"}},[r("div",{staticStyle:{"padding-right":"100px"}},[e._v("角色")]),r("el-select",{staticStyle:{width:"300px"},attrs:{size:"small",filterable:"",placeholder:"请选择"},on:{change:e.selectRole},model:{value:e.queryRoleName,callback:function(t){e.queryRoleName=t},expression:"queryRoleName"}},e._l(e.roleOptions,(function(e){return r("el-option",{key:e.roleId,attrs:{label:e.roleName,value:e.roleId}})})),1)],1),r("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center"}},[r("div",{staticStyle:{"padding-right":"100px"}},[e._v("部门")]),r("el-select",{ref:"deptSelect",staticStyle:{width:"300px"},attrs:{size:"small",filterable:"",placeholder:"请选择","filter-method":e.deptSelectFilter},model:{value:e.deptSelectName,callback:function(t){e.deptSelectName=t},expression:"deptSelectName"}},[r("el-option",{staticStyle:{height:"100%",padding:"0"},attrs:{value:""}},[r("el-tree",{ref:"deptSelectTree",staticClass:"down-tree",staticStyle:{height:"200px","font-weight":"normal"},attrs:{data:e.deptOptions,props:e.deptProps,"node-key":e.deptProps.id,"expand-on-click-node":!0,"filter-node-method":e.filterDeptSelectNode,"highlight-current":"","default-expand-all":""},on:{"node-click":e.handleDeptSelectNodeClick}})],1)],1)],1)])])],1),r("div",{staticClass:"user-table-container"},[r("div",{staticClass:"user-table"},[r("div",{staticStyle:{display:"flex","flex-direction":"column",width:"47%",height:"300px"}},[r("el-table",{ref:"multipleLeftTable",attrs:{height:"300",data:e.localUserTableListShow.slice((e.pageAll.pageNum-1)*e.pageAll.pageSize,e.pageAll.pageNum*e.pageAll.pageSize),border:"","row-key":e.getUserRowKeys,"row-style":{height:"30px"},"cell-style":{padding:"0px"},"header-row-style":{height:"30px"},"header-cell-style":{padding:"0px"}},on:{"selection-change":e.selectLeftItem,"row-dblclick":e.handleLeftRowDoubleClick}},[r("el-table-column",{attrs:{type:"selection","reserve-selection":!1,width:"50",align:"center"}}),r("el-table-column",{attrs:{label:"用户名",align:"center",prop:"nickName"}}),r("el-table-column",{attrs:{label:"部门",align:"center",prop:"deptName"}})],1),r("pagination",{attrs:{total:e.localUserTableListShow.length,page:e.pageAll.pageNum,limit:e.pageAll.pageSize,layout:"total, prev, pager, next","pager-count":4},on:{"update:page":function(t){return e.$set(e.pageAll,"pageNum",t)},"update:limit":function(t){return e.$set(e.pageAll,"pageSize",t)}}})],1),r("div",{staticStyle:{display:"flex","flex-direction":"column",width:"6%","justify-content":"space-around","align-items":"center"}},[r("img",{staticStyle:{width:"40px",height:"40px"},attrs:{src:s("a6ff"),alt:""},on:{click:e.goRight}}),r("img",{staticStyle:{width:"40px",height:"40px"},attrs:{src:s("d5b1"),alt:""},on:{click:e.goLeft}}),r("img",{staticStyle:{width:"40px",height:"40px"},attrs:{src:s("be9f"),alt:""},on:{click:e.goRightAll}}),r("img",{staticStyle:{width:"40px",height:"40px"},attrs:{src:s("c0f8"),alt:""},on:{click:e.goLeftAll}})]),r("div",{staticStyle:{display:"flex","flex-direction":"column",width:"47%",height:"300px"}},[r("el-table",{ref:"multipleRightTable",attrs:{height:"300",data:e.selectUserTableListShow.slice((e.pageSelect.pageNum-1)*e.pageSelect.pageSize,e.pageSelect.pageNum*e.pageSelect.pageSize),border:"","row-key":e.getUserRowKeys,"row-style":{height:"30px"},"cell-style":{padding:"0px"},"header-row-style":{height:"30px"},"header-cell-style":{padding:"0px"}},on:{"selection-change":e.selectRightItem,"row-dblclick":e.handleRightRowDoubleClick}},[r("el-table-column",{attrs:{type:"selection","reserve-selection":!1,width:"50",align:"center"}}),r("el-table-column",{attrs:{label:"用户名",align:"center",prop:"nickName"}}),r("el-table-column",{attrs:{label:"部门",align:"center",prop:"deptName"}})],1),r("pagination",{attrs:{total:e.selectUserTableListShow.length,page:e.pageSelect.pageNum,limit:e.pageSelect.pageSize,layout:"total, prev, pager, next","pager-count":4},on:{"update:page":function(t){return e.$set(e.pageSelect,"pageNum",t)},"update:limit":function(t){return e.$set(e.pageSelect,"pageSize",t)}}})],1)])])],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:e.submitUserData}},[e._v("确 定")]),r("el-button",{on:{click:function(t){e.userData.open=!1}}},[e._v("取 消")])],1)]):e._e(),e.forwardDialogOpen?r("el-dialog",{attrs:{title:e.forwardDialogTitle(e.forwardType),visible:e.forwardDialogOpen,width:"70vw","append-to-body":""},on:{"update:visible":function(t){e.forwardDialogOpen=t}}},[r("ForwardView",{attrs:{procInsId:e.taskForm.procInsId,taskId:e.taskForm.taskId,recordId:e.recordId,dialogType:e.forwardType,show:e.forwardDialogOpen},on:{"update:show":function(t){e.forwardDialogOpen=t},"back-home":e.handleBackHome}})],1):e._e()],2)},a=[],i=s("e378"),o=i["a"],n=(s("e6e7"),s("e9fa"),s("2877")),l=Object(n["a"])(o,r,a,!1,null,"6044b7a5",null);t["default"]=l.exports},"9a9d":function(e,t,s){"use strict";s.d(t,"c",(function(){return a})),s.d(t,"a",(function(){return i})),s.d(t,"d",(function(){return o})),s.d(t,"i",(function(){return n})),s.d(t,"h",(function(){return l})),s.d(t,"f",(function(){return _})),s.d(t,"b",(function(){return c})),s.d(t,"g",(function(){return d})),s.d(t,"e",(function(){return u}));var r=s("b775");function a(e){return Object(r["a"])({url:"/flowable/task/complete",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/flowable/task/complete/allApproval",method:"post",data:e})}function o(e){return Object(r["a"])({url:"/flowable/task/delegate",method:"post",data:e})}function n(e){return Object(r["a"])({url:"/flowable/task/transfer",method:"post",data:e})}function l(e){return Object(r["a"])({url:"/flowable/task/return",method:"post",data:e})}function _(e){return Object(r["a"])({url:"/flowable/task/reject",method:"post",data:e})}function c(e){return Object(r["a"])({url:"/flowable/task/claim",method:"post",data:e})}function d(e){return Object(r["a"])({url:"/flowable/task/returnList",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/flowable/task/forward",method:"post",data:e})}},ccdc:function(e,t,s){},e378:function(module,__webpack_exports__,__webpack_require__){"use strict";var _home_jenkins_workspace_cyou_oa_web_prod_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("5530"),_home_jenkins_workspace_cyou_oa_web_prod_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("b85c"),_home_jenkins_workspace_cyou_oa_web_prod_node_modules_babel_runtime_helpers_esm_typeof_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("53ca"),core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("99af"),core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("4de4"),core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_array_find_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("7db0"),core_js_modules_es_array_find_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_array_find_js__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_array_from_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("a630"),core_js_modules_es_array_from_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_array_from_js__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("caad"),core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es_array_join_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("a15b"),core_js_modules_es_array_join_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es_array_join_js__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("d81d"),core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("14d9"),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_10__),core_js_modules_es_array_slice_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("fb6a"),core_js_modules_es_array_slice_js__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(core_js_modules_es_array_slice_js__WEBPACK_IMPORTED_MODULE_11__),core_js_modules_es_array_splice_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("a434"),core_js_modules_es_array_splice_js__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(core_js_modules_es_array_splice_js__WEBPACK_IMPORTED_MODULE_12__),core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("b0c0"),core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_13__),core_js_modules_es_object_keys_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("b64b"),core_js_modules_es_object_keys_js__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(core_js_modules_es_object_keys_js__WEBPACK_IMPORTED_MODULE_14__),core_js_modules_es_object_seal_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("af93"),core_js_modules_es_object_seal_js__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(core_js_modules_es_object_seal_js__WEBPACK_IMPORTED_MODULE_15__),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("d3b7"),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_16__),core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("ac1f"),core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_17__),core_js_modules_es_set_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("6062"),core_js_modules_es_set_js__WEBPACK_IMPORTED_MODULE_18___default=__webpack_require__.n(core_js_modules_es_set_js__WEBPACK_IMPORTED_MODULE_18__),core_js_modules_es_string_includes_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("2532"),core_js_modules_es_string_includes_js__WEBPACK_IMPORTED_MODULE_19___default=__webpack_require__.n(core_js_modules_es_string_includes_js__WEBPACK_IMPORTED_MODULE_19__),core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("3ca3"),core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_20___default=__webpack_require__.n(core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_20__),core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("5319"),core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_21___default=__webpack_require__.n(core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_21__),core_js_modules_es_string_trim_js__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__("498a"),core_js_modules_es_string_trim_js__WEBPACK_IMPORTED_MODULE_22___default=__webpack_require__.n(core_js_modules_es_string_trim_js__WEBPACK_IMPORTED_MODULE_22__),core_js_modules_esnext_iterator_constructor_js__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__("0643"),core_js_modules_esnext_iterator_constructor_js__WEBPACK_IMPORTED_MODULE_23___default=__webpack_require__.n(core_js_modules_esnext_iterator_constructor_js__WEBPACK_IMPORTED_MODULE_23__),core_js_modules_esnext_iterator_filter_js__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__("2382"),core_js_modules_esnext_iterator_filter_js__WEBPACK_IMPORTED_MODULE_24___default=__webpack_require__.n(core_js_modules_esnext_iterator_filter_js__WEBPACK_IMPORTED_MODULE_24__),core_js_modules_esnext_iterator_find_js__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__("fffc"),core_js_modules_esnext_iterator_find_js__WEBPACK_IMPORTED_MODULE_25___default=__webpack_require__.n(core_js_modules_esnext_iterator_find_js__WEBPACK_IMPORTED_MODULE_25__),core_js_modules_esnext_iterator_for_each_js__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__("4e3e"),core_js_modules_esnext_iterator_for_each_js__WEBPACK_IMPORTED_MODULE_26___default=__webpack_require__.n(core_js_modules_esnext_iterator_for_each_js__WEBPACK_IMPORTED_MODULE_26__),core_js_modules_esnext_iterator_map_js__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__("a573"),core_js_modules_esnext_iterator_map_js__WEBPACK_IMPORTED_MODULE_27___default=__webpack_require__.n(core_js_modules_esnext_iterator_map_js__WEBPACK_IMPORTED_MODULE_27__),core_js_modules_esnext_iterator_some_js__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__("9a9a"),core_js_modules_esnext_iterator_some_js__WEBPACK_IMPORTED_MODULE_28___default=__webpack_require__.n(core_js_modules_esnext_iterator_some_js__WEBPACK_IMPORTED_MODULE_28__),core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__("159b"),core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_29___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_29__),core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__("ddb0"),core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_30___default=__webpack_require__.n(core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_30__),_api_workflow_process__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__("ca94"),_api_workflow_task__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__("9a9d"),_api_system_user__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__("c0c7"),_api_system_role__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__("3528"),_components_ProcessViewer__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__("ff87"),_riophae_vue_treeselect_dist_vue_treeselect_css__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__("542c"),_riophae_vue_treeselect_dist_vue_treeselect_css__WEBPACK_IMPORTED_MODULE_36___default=__webpack_require__.n(_riophae_vue_treeselect_dist_vue_treeselect_css__WEBPACK_IMPORTED_MODULE_36__),_riophae_vue_treeselect__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__("ca17"),_riophae_vue_treeselect__WEBPACK_IMPORTED_MODULE_37___default=__webpack_require__.n(_riophae_vue_treeselect__WEBPACK_IMPORTED_MODULE_37__),_utils_auth__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__("5f87"),_api_system_customDict__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__("7aee"),_api_workflow_printDetail__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__("224d"),_wangeditor_editor_for_vue__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__("4e15"),_wangeditor_editor_dist_css_style_css__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__("560e"),_wangeditor_editor_dist_css_style_css__WEBPACK_IMPORTED_MODULE_42___default=__webpack_require__.n(_wangeditor_editor_dist_css_style_css__WEBPACK_IMPORTED_MODULE_42__),_components_WangRichText__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__("88b5"),_api_workflow_forward__WEBPACK_IMPORTED_MODULE_44__=__webpack_require__("30ff"),_components_ForwardView__WEBPACK_IMPORTED_MODULE_45__=__webpack_require__("583d");__webpack_exports__["a"]={name:"WorkDetail",components:{ProcessViewer:_components_ProcessViewer__WEBPACK_IMPORTED_MODULE_35__["a"],Treeselect:_riophae_vue_treeselect__WEBPACK_IMPORTED_MODULE_37___default.a,Editor:_wangeditor_editor_for_vue__WEBPACK_IMPORTED_MODULE_41__["a"],Toolbar:_wangeditor_editor_for_vue__WEBPACK_IMPORTED_MODULE_41__["b"],WangRichText:_components_WangRichText__WEBPACK_IMPORTED_MODULE_43__["a"],ForwardView:_components_ForwardView__WEBPACK_IMPORTED_MODULE_45__["a"]},props:{},computed:{allAttachments:function(){var e=[];return this.processNodeHistory&&this.processNodeHistory.length>0&&this.processNodeHistory.forEach((function(t){t.fileList&&t.fileList.length>0&&t.fileList.forEach((function(s){s&&e.push({fileName:s.fileName,filePath:s.filePath,uploader:t.assigneeName,nodeName:t.activityName||("endEvent"===t.activityType?"结束流程":""),uploadTime:t.endTime})}))})),this.historyProcNodeList&&this.historyProcNodeList.length>0&&this.historyProcNodeList.forEach((function(t){t.opinionList&&t.opinionList.length>0&&t.opinionList.forEach((function(t){t.fileList&&t.fileList.length>0&&t.fileList.forEach((function(s){s&&s.fileName&&e.push({fileName:s.fileName,filePath:s.fileUrl||s.filePath,uploader:t.operatorName,nodeName:"转发",uploadTime:t.createTime})})),t.assigneeFileList&&t.assigneeFileList.length>0&&t.assigneeFileList.forEach((function(s){s&&s.fileName&&e.push({fileName:s.fileName,filePath:s.fileUrl||s.filePath,uploader:t.assigneeName,nodeName:"转发回复",uploadTime:t.endTime})}))}))})),this.fileList&&this.fileList.length>0&&this.fileList.forEach((function(t){t.response&&t.response.data&&e.push({fileName:t.name,filePath:t.response.data.filePath,uploader:"当前用户",nodeName:"当前节点",uploadTime:"刚刚"})})),e},commentType:function(){return function(e){switch(e){case"1":return"通过";case"2":return"退回";case"3":return"驳回";case"4":return"转发";case"5":return"转办";case"6":return"终止";case"7":return"撤回";case"8":return"干预";case"9":return"抄送";case"comment":return"批注"}}},approveTypeTag:function(){return function(e){switch(e){case"1":return"success";case"2":return"warning";case"3":return"danger";case"4":return"primary";case"5":return"success";case"6":return"danger";case"7":return"info";case"8":return"warning";case"9":return"warning";case"comment":return"info"}}},forwardDialogTitle:function(){return function(e){switch(e){case"forward":return"任务转发";case"note":return"填写批注";case"transfer":return"任务转办"}}},isSingle:function(){return"next"!==this.userData.type&&"copy"!==this.userData.type}},data:function(){return{headers:{Authorization:"Bearer "+Object(_utils_auth__WEBPACK_IMPORTED_MODULE_38__["a"])()},fileList:[],user:{},processCode:"",showUserDeptInfo:!0,height:document.documentElement.clientHeight-205+"px;",loadIndex:0,xmlData:void 0,finishedInfo:{finishedSequenceFlowSet:[],finishedTaskSet:[],unfinishedTaskSet:[],rejectedTaskSet:[]},processNodeHistory:[],historyProcNodeList:[],deptName:"",roleName:"",userName:"",deptOptions:void 0,roleOptions:[],userLoading:!1,userList:null,deptProps:{children:"children",label:"label"},roleProps:{label:"roleName"},queryParams:{deptId:"",roleId:"",nickName:""},total:0,loading:!0,taskForm:{comment:"",procInsId:"",taskId:"",copyUserIds:"",vars:"",targetKey:"",sourceInstId:""},rules:{comment:[{required:!1,message:"请输入审批意见",trigger:"blur"}]},variables:[],taskFormOpen:!1,taskFormData:{},mainFormData:{},mainFormEditFlag:!1,mainWidgetsEditFlag:!1,editWidgetsList:[],hideFormWidgetsFlag:!1,hideWidgetsList:[],taskStartFlag:!1,taskAuditFlag:!1,processFormList:[],formOpen:!1,returnTaskList:[],processed:!1,isRunning:!1,returnTitle:null,returnOpen:!1,rejectOpen:!1,rejectTitle:null,userData:{title:"",type:"",open:!1},copyUser:[],nextUser:[],userMultipleSelection:[],userDialogTitle:"",formData:{},userOpen:!1,activeName:"3",localUserTableList:[],localUserTableListShow:[],selectUserTableList:[],selectUserTableListShow:[],searchLocalUserName:"",searchSelectUserName:"",pageAll:{pageNum:1,pageSize:7},pageSelect:{pageNum:1,pageSize:7},queryRoleName:"",queryDeptName:"",deptSelectName:"",selectedLeftForms:[],selectedRightForms:[],isStartNode:!1,isTodoPerson:!1,hideTransferButtons:!1,pageLoading:!0,activeTabName:"",initialized:!1,showFlags:[],wangeditor:null,toolbarConfig:{excludeKeys:["fullScreen","insertVideo","insertImage"]},editorConfig:{readOnly:!1,placeholder:"请输入 审批意见",MENU_CONF:{}},showNote:!1,showForward:!0,recordId:null,forwardDialogOpen:!1,forwardType:"",invoiceImgUrls:[]}},created:function(){var e=this.$route.params.procInsId;this.hasStrictPermission(e),this.wangEditorConfig(),this.initData()},mounted:function(){this.$el.addEventListener("click",this.handleFormClick,!0)},beforeDestroy:function(){this.$el.removeEventListener("click",this.handleFormClick,!0)},watch:{deptName:function(e){this.$refs.deptTree.filter(e)},roleName:function(e){this.$refs.roleTree.filter(e)},"userData.open":function(e,t){console.log("userData.open 发生了变化:",e,t),e||(this.queryParams.nickName="",this.queryParams.roleId="",this.queryParams.deptId="",this.activeName="3")},"userData.type":function(e,t){"delegate"!==e&&"transfer"!==e&&"forward"!==e||(this.selectUserTableList=[],this.selectUserTableListShow=[])}},methods:{handleFormClick:function(e){var t=this,s=e.target.closest(".upload-file-name");if(s){var r=e.target,a=r.tagName.toLowerCase();if(["i","svg","use","path","button","a","img"].includes(a))return;if(r.className&&"string"===typeof r.className){var i=r.className.toLowerCase();if(i.includes("icon")||i.includes("btn")||i.includes("download")||i.includes("delete"))return}if(r.closest("a, button, i, svg, .el-upload-list__item-status-label"))return;var o=s.innerText.trim();if(!o)return;var n=r.innerText?r.innerText.trim():"";if(!n)return;if(!o.includes(n))return;var l=this.findUrlRecursively(this.formData,o);if(l||(l=this.findUrlRecursively(this.processFormList,o)),!l&&this.taskFormData&&(l=this.findUrlRecursively(this.taskFormData,o)),l)window.location.href="/cyouNeiOaServer/system/file/download?url="+encodeURIComponent(l)+"&fileName="+encodeURIComponent(o);else if(this.$refs.vFormRef){var _;try{_=this.$refs.vFormRef.getFormData(!1)}catch(c){console.error("getFormData error:",c)}Promise.resolve(_).then((function(e){l=t.findUrlRecursively(e,o),l?window.location.href="/cyouNeiOaServer/system/file/download?url="+encodeURIComponent(l)+"&fileName="+encodeURIComponent(o):t.$message.warning("未找到文件链接")})).catch((function(e){console.warn("Failed to get form data",e)}))}else this.$message.warning("未找到文件链接")}},findUrlRecursively:function(e,t){if(!e||"object"!==Object(_home_jenkins_workspace_cyou_oa_web_prod_node_modules_babel_runtime_helpers_esm_typeof_js__WEBPACK_IMPORTED_MODULE_2__["a"])(e))return null;if(Array.isArray(e)){var s,r=Object(_home_jenkins_workspace_cyou_oa_web_prod_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper_js__WEBPACK_IMPORTED_MODULE_1__["a"])(e);try{for(r.s();!(s=r.n()).done;){var a=s.value,i=this.findUrlRecursively(a,t);if(i)return i}}catch(c){r.e(c)}finally{r.f()}}else{var o=e.name||e.fileName;if(o===t){var n=e.url||e.filePath||e.response&&e.response.data&&e.response.data.filePath;if(n)return n}for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){var _=this.findUrlRecursively(e[l],t);if(_)return _}}return null},downloadFile:function(e){window.location.href="/cyouNeiOaServer/system/file/download?url="+encodeURIComponent(e.filePath)+"&fileName="+encodeURIComponent(e.fileName)},downloadAllAttachments:function(){var e=this;0!==this.allAttachments.length?this.allAttachments.forEach((function(t,s){setTimeout((function(){e.downloadFile(t)}),500*s)})):this.$message.info("暂无附件可下载")},handleShow:function(e){this.$set(this.showFlags,e,!0)},hasStrictPermission:function(e){Object(_utils_auth__WEBPACK_IMPORTED_MODULE_38__["a"])()?null!=e&&""!=e&&void 0!=e||this.$router.push({path:"/404"}):next("/login")},handleSuccess:function(e,t,s){this.fileList=s},handlePreview:function(e){var t=e.response.data.filePath;window.open(t,"_blank")},handleExceed:function(e,t){this.$message.warning("当前限制选择 30 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},beforeUpload:function(e){var t=e.size/1024/1024<30;return t||this.$message.error("上传文件大小不能超过30MB!"),t},beforeRemove:function(e,t){if(e&&"success"===e.status)return this.$confirm("确定移除 ".concat(e.name,"？"))},handleTabClick:function(e,t){var s=this;this.activeTabName=e.name,"approval"==e.name?this.$refs.vMainFormRef&&(this.mainWidgetsEditFlag?this.editWidgetsList.forEach((function(e){s.$refs.vMainFormRef.enableWidgets(e)})):this.$refs.vMainFormRef.enableForm()):"form"==e.name&&this.$refs.vMainFormRef&&this.$refs.vMainFormRef.disableForm()},initData:function initData(){var _this5=this;this.taskForm.procInsId=this.$route.params&&this.$route.params.procInsId;var procDefId=this.$route.query&&this.$route.query.procDefId,forwardId=this.$route.query&&this.$route.query.forwardId;Object(_api_system_customDict__WEBPACK_IMPORTED_MODULE_39__["d"])({dictKey:"hide_dept_info"}).then((function(e){var t,s=null===(t=e.rows[0])||void 0===t?void 0:t.value;s.includes(procDefId)&&(_this5.showUserDeptInfo=!1)})),this.taskForm.taskId=this.$route.query&&this.$route.query.taskId,this.taskForm.sourceInstId=this.$route.query&&this.$route.query.sourceInstId,this.processed=this.$route.query&&eval(this.$route.query.processed||!1),this.getProcessDetails(this.taskForm.procInsId,this.taskForm.taskId,this.taskForm.sourceInstId),this.loadIndex=this.taskForm.procInsId,void 0!==forwardId&&(this.showForward=!1,this.getForwardFlag(forwardId)),this.initialized=!0},wangEditorConfig:function(){this.editorConfig.MENU_CONF["uploadImage"]={server:"/cyouNeiOaServer/system/file/upload",fieldName:"file",headers:{Authorization:"Bearer "+Object(_utils_auth__WEBPACK_IMPORTED_MODULE_38__["a"])()},meta:{key:"wangeditor-filename"},customInsert:function(e,t){t(e.data.filePath,e.data.fileName,"")}}},getTreeSelect:function(){var e=this;return new Promise((function(t,s){!e.deptOptions||e.deptOptions.length<=0?Object(_api_system_user__WEBPACK_IMPORTED_MODULE_33__["f"])().then((function(s){e.deptOptions=s.data,t()})):s()}))},applyViewReadonly:function(){try{var e=this.$el.querySelector(".form-view-ui");if(!e)return;var t=e.querySelectorAll("input.el-input__inner, textarea.el-textarea__inner");t.forEach((function(e){e.removeAttribute("disabled"),e.setAttribute("readonly","readonly")}));var s=e.querySelectorAll("[contenteditable]");s.forEach((function(e){e.setAttribute("contenteditable","false")}))}catch(r){console.warn("applyViewReadonly error:",r)}},disableViewInteractionsExceptPromotion:function(){try{var e=this.$el.querySelector(".form-view-ui");if(!e)return;this._viewBlockClickHandler&&(e.removeEventListener("click",this._viewBlockClickHandler,!0),e.removeEventListener("focusin",this._viewBlockFocusHandler,!0),e.removeEventListener("mousedown",this._viewBlockMouseDownHandler,!0));var t=function(e){var t=e.target;if(!t.closest(".el-icon-s-promotion")&&!t.closest("a[href]")&&!t.closest(".link-text .el-input-group__append")&&!t.closest(".link-text .el-input-group__append .el-button")){if(t.closest(".el-input__clear")||t.closest(".el-input__suffix")||t.closest(".el-input__prefix"))return e.stopPropagation(),void e.preventDefault();if(t.closest(".el-select")||t.closest(".el-date-editor")||t.closest(".el-time-picker")||t.closest(".el-cascader"))return e.stopPropagation(),void e.preventDefault();if(t.closest(".el-upload"))return e.stopPropagation(),void e.preventDefault();if(t.closest(".form-view-ui .el-button")){var s=t.closest(".el-button"),r=!(!s.closest(".sub-form-container")&&!s.closest(".sub-form-table-column"));if(!r)return;if(s&&(s.closest(".link-text")||s.querySelector(".el-icon-s-promotion")))return;return s&&(s.querySelector(".el-icon-plus")||s.querySelector(".el-icon-delete")),e.stopPropagation(),void e.preventDefault()}}};e.addEventListener("click",t,!0),this._viewBlockClickHandler=t;var s=function(e){var t=e.target;if(!t.closest(".el-icon-s-promotion")&&t.matches("input.el-input__inner")&&(t.closest(".el-date-editor")||t.closest(".el-time-picker"))){try{t.blur()}catch(s){}return e.stopPropagation(),void e.preventDefault()}};e.addEventListener("focusin",s,!0),this._viewBlockFocusHandler=s;var r=function(e){var t=e.target;if(!t.closest(".el-icon-s-promotion")){if(t.closest(".el-date-editor")||t.closest(".el-time-picker")||t.closest(".el-upload"))return e.stopPropagation(),void e.preventDefault();if(t.closest(".el-button")){var s=t.closest(".el-button"),r=!(!s.closest(".sub-form-container")&&!s.closest(".sub-form-table-column"));if(!r)return;if(s&&(s.closest(".link-text")||s.querySelector(".el-icon-s-promotion")))return;return e.stopPropagation(),void e.preventDefault()}}};e.addEventListener("mousedown",r,!0),this._viewBlockMouseDownHandler=r}catch(a){console.warn("disableViewInteractionsExceptPromotion error:",a)}},getRoleOptions:function(){var e=this;Object(_api_system_role__WEBPACK_IMPORTED_MODULE_34__["l"])(this.roleQueryParams).then((function(t){e.roleOptions=t.rows}))},getUserList:function(){var e=this;console.log("查询用户列表：",this.queryParams),this.userLoading=!0;var t=Object(_home_jenkins_workspace_cyou_oa_web_prod_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__["a"])({},this.queryParams);Object(_api_system_user__WEBPACK_IMPORTED_MODULE_33__["l"])(this.addDateRange(t,this.dateRange)).then((function(t){e.localUserTableList=t.rows,e.localUserTableListShow=t.rows,e.userLoading=!1}))},filterDeptNode:function(e,t){return!e||-1!==t.label.indexOf(e)},filterDeptSelectNode:function(e,t){return!e||-1!==t.label.indexOf(e)},setIcon:function(e){return e?"el-icon-check":"el-icon-time"},setColor:function(e){return e?"#2bc418":"#b3bdbb"},selectRightItem:function(e){this.selectedRightForms=e},selectLeftItem:function(e){var t=this;if(this.isSingle)if(e.length>1){var s=e[e.length-1];this.selectedLeftForms=[s],e.forEach((function(s,r){r!==e.length-1&&t.$refs.multipleLeftTable.toggleRowSelection(s,!1)}))}else this.selectedLeftForms=e;else this.selectedLeftForms=e},toggleSelection:function(e){var t=this;e&&e.length>0?this.$nextTick((function(){e.forEach((function(e){var s=t.userList.find((function(t){return t.userId===e.userId}));t.$refs.userTable.toggleRowSelection(s)}))})):this.$nextTick((function(){t.$refs.userTable.clearSelection()}))},handleClose:function(e,t){var s=this.selectUserTableList.find((function(e){return e.userId===t.id}));if(this.selectUserTableList.splice(this.selectUserTableList.indexOf(s),1),"copy"===e)if(this.copyUser=this.selectUserTableList,this.copyUser&&this.copyUser.length>0){var r=this.copyUser.map((function(e){return e.id}));this.taskForm.copyUserIds=r instanceof Array?r.join(","):r}else this.taskForm.copyUserIds="";else if("next"===e)if(this.nextUser=this.selectUserTableList,this.nextUser&&this.nextUser.length>0){var a=this.nextUser.map((function(e){return e.id}));this.taskForm.nextUserIds=a instanceof Array?a.join(","):a}else this.taskForm.nextUserIds=""},handleCheckChange:function(e){this.taskForm.values=e instanceof Array?{approval:e.join(",")}:{approval:e}},isActive:function(e){return e.path===this.$route.path},toLastView:function(e,t){var s=e.slice(-1)[0];s?this.$router.push(s.fullPath):"Dashboard"===t.name?this.$router.replace({path:"/redirect"+t.fullPath}):this.$router.push("/")},getProcessDetails:function(e,t,s){var r=this;this.pageLoading=!0;var a={procInsId:e,taskId:t,sourceInstId:s};Object(_api_workflow_process__WEBPACK_IMPORTED_MODULE_31__["d"])(a).then((function(e){var t=e.data;if(r.xmlData=t.bpmnXml,null==r.xmlData){r.$message({message:"该流程实例已被删除",type:"error"});var s=r.$store.state.tagsView.visitedViews.find((function(e){return e.path===r.$route.path}));r.$tab.closePage(s).then((function(e){var t=e.visitedViews;r.isActive(s)&&r.toLastView(t,s)}))}else{var a;if(r.processCode=t.processCode,r.taskFormData=t.taskFormData,r.taskFormOpen=t.existTaskForm,r.processFormList=t.processFormList,r.processFormList&&r.processFormList.length>0){var i=function(e){e&&e.forEach((function(e){"button"!==e.type&&"static-button"!==e.type||!e.options||"已录入发票，点击关联"!==e.options.label||(r.$set(e.options,"disabled",!0),r.$set(e.options,"hidden",!1)),e.widgetList&&i(e.widgetList),e.cols&&e.cols.forEach((function(e){return i(e.widgetList)})),e.tabs&&e.tabs.forEach((function(e){return i(e.widgetList)})),e.rows&&e.rows.forEach((function(e){return i(e.widgetList)}))}))};r.processFormList.forEach((function(e){i(e.widgetList)}))}r.invoiceImgUrls=(null===(a=t.invoiceImgUrls)||void 0===a?void 0:a.length)>0?t.invoiceImgUrls.split(","):[],t.taskPropertyData&&t.taskPropertyData.mainFormEditFlag&&"1"==t.taskPropertyData.mainFormEditFlag&&(r.mainFormEditFlag=!0,r.mainFormData=r.processFormList[0]),t.taskPropertyData&&t.taskPropertyData.taskStartFlag&&"1"==t.taskPropertyData.taskStartFlag?(r.taskStartFlag=!0,r.mainFormData=r.processFormList[0],r.taskAuditFlag=!0):r.taskAuditFlag=!0,t.taskPropertyData&&t.taskPropertyData.editWidgets&&t.taskPropertyData.editWidgets.length>0&&(r.mainFormData=r.processFormList[0],r.mainWidgetsEditFlag=!0,r.editWidgetsList=t.taskPropertyData.editWidgets.split(",")),t.hideFormFields&&t.hideFormFields.length>0&&(r.hideFormWidgetsFlag=!0,r.hideWidgetsList=t.hideFormFields.split(","));var o=[];t.enableFormFields&&t.enableFormFields.length>0&&(o=t.enableFormFields.split(",")),r.historyProcNodeList=t.historyProcNodeList,r.processNodeHistory=t.processNodeHistory,r.finishedInfo=t.flowViewer,r.formData=t.flowFormData,r.user=t.initiatorUser,r.formOpen=!0,t.historyProcNodeList[t.historyProcNodeList.length-2].activityId===t.historyProcNodeList[0].activityId&&(r.isStartNode=!0),r.isTodoPerson=t.isTodoPerson,t.isTodoPerson||(r.taskFormOpen=!1),r.isRunning=t.isRunning,r.hideTransferButtons=t.hideTransferButtons;var n=r;r.$nextTick((function(){r.$refs.vFormRefDetail&&r.$refs.vFormRefDetail.forEach((function(e){n.hideFormWidgetsFlag&&e.hideWidgets(n.hideWidgetsList),o.forEach((function(t){e.findWidgetAndSetDisabled(t,!1)}))})),n.applyViewReadonly(),n.disableViewInteractionsExceptPromotion(),r.$refs.vMainFormRef&&(r.mainWidgetsEditFlag?r.editWidgetsList.forEach((function(e){r.$refs.vMainFormRef.enableWidgets(e)})):r.$refs.vMainFormRef.enableForm())}))}})).catch((function(e){console.log(e),r.showForward=!1})).finally((function(){r.pageLoading=!1,r.$nextTick((function(){var e="approval",t={name:e};r.handleTabClick(t)}))}))},getForwardFlag:function(e){var t=this;Object(_api_workflow_forward__WEBPACK_IMPORTED_MODULE_44__["a"])(e).then((function(e){t.showNote="pending"===e.data.recordStatus,t.recordId=e.data.recordId,t.adjustNoteButtonPosition()}))},adjustNoteButtonPosition:function(){var e=this;this.$nextTick((function(){if(e.showNote&&!e.showForward){var t=document.getElementById("noteButton");t.style.top="150px"}}))},onSelectCopyUsers:function(){this.selectUserTableList=this.copyUser,this.selectUserTableListShow=this.selectUserTableList,this.searchLocalUserName="",this.searchSelectUserName="",this.onSelectUsers("添加抄送人","copy")},onSelectNextUsers:function(){this.selectUserTableList=this.nextUser,this.selectUserTableListShow=this.selectUserTableList,this.searchLocalUserName="",this.searchSelectUserName="",this.onSelectUsers("指定审批人","next")},onSelectUsers:function(e,t){this.userData.title=e,this.userData.type=t,this.getTreeSelect(),this.getRoleOptions(),this.getUserList(),this.userData.open=!0},handleComplete:function(){var e,t,s=this,r=this,a=this.$refs.vFormRef,i=void 0!==a,o=!i||new Promise((function(t,a){r.$refs.vFormRef.getFormData().then((function(s){e=s,t()})).catch((function(e){a();var t=JSON.parse(e),r=s.$refs.vFormRef.getWidgetRef(t.field);r&&"function"===typeof r.focus&&r.focus(),t&&t.message?s.$message.error(t.message):s.$message.error("您有必填项未填或必填项校验失败")}))})),n=this.$refs.vMainFormRef,l=void 0!==n,_=!l||new Promise((function(e,s){r.$refs.vMainFormRef.getFormData().then((function(s){t=s,e()})).catch((function(e){s()}))})),c=new Promise((function(e,t){s.$refs["taskForm"].validate((function(s){s?e():t()}))}));Promise.all([o,_,c]).then((function(){if(i&&(s.taskForm.variables=e),l&&(s.taskForm.variablesMain=t),s.fileList.length>0){var r=new Array;s.fileList.forEach((function(e){r.push(e.response.data)})),void 0==s.taskForm.variablesFile&&(s.taskForm.variablesFile={}),s.taskForm.variablesFile={fileList:r}}Object(_api_workflow_task__WEBPACK_IMPORTED_MODULE_32__["c"])(s.taskForm).then((function(e){s.$modal.msgSuccess(e.msg),s.goBack()}))}))},handleDelegate:function(){var e=this;this.$refs["taskForm"].validate((function(t){t&&(e.userData.type="delegate",e.userData.title="转发任务",e.userData.open=!0,e.getTreeSelect(),e.getRoleOptions(),e.getUserList())}))},handleTransfer:function(){this.forwardType="transfer",this.forwardDialogOpen=!0},handleReject:function(){var e=this;this.$refs["taskForm"].validate((function(t){if(t){var s=e;e.$modal.confirm("拒绝审批单流程会终止，是否继续？").then((function(){return Object(_api_workflow_task__WEBPACK_IMPORTED_MODULE_32__["f"])(s.taskForm)})).then((function(t){e.$modal.msgSuccess(t.msg),e.goBack()}))}}))},goBack:function(){this.$tab.closePage(this.$route),this.$router.back()},getData:function(e){if(e){var t=[];e.fields.forEach((function(e){var s={};if(s.label=e.__config__.label,e.__config__.defaultValue instanceof Array){var r=[];e.__config__.defaultValue.forEach((function(e){r.push(e)})),s.val=r}else s.val=e.__config__.defaultValue;t.push(s)})),this.variables=t}},submitUserData:function(){var e=this,t=this.userData.type;if("copy"===t||"next"===t){if(!this.selectUserTableList||this.selectUserTableList.length<=0)return this.$modal.msgError("请选择用户"),!1;var s=this.selectUserTableList.map((function(e){return e.userId}));"copy"===t?(this.copyUser=this.selectUserTableList,this.taskForm.copyUserIds=s instanceof Array?s.join(","):s):"next"===t&&(this.nextUser=this.selectUserTableList,this.taskForm.nextUserIds=s instanceof Array?s.join(","):s),this.userData.open=!1}else{if(!this.selectUserTableList||this.selectUserTableList.length<=0)return this.$modal.msgError("请选择用户"),!1;var r=this.selectUserTableList[0].userId;this.taskForm.userId=r,"delegate"===t&&Object(_api_workflow_task__WEBPACK_IMPORTED_MODULE_32__["d"])(this.taskForm).then((function(t){e.$modal.msgSuccess(t.msg),e.goBack()}))}},handleReturn:function(){var e=this;this.$refs["taskForm"].validate((function(t){t&&(e.returnTitle="退回流程",Object(_api_workflow_task__WEBPACK_IMPORTED_MODULE_32__["g"])(e.taskForm).then((function(t){e.returnTaskList=t.data;for(var s=0;s<e.returnTaskList.length;s++){var r=e.returnTaskList[s],a=r.executionListeners;if(a&&a.length>0){var i=!1;a.forEach((function(e){"com.cyou.flowable.listener.LastHandlerLeaderCycleTaskListener"!=e.implementation&&"com.cyou.flowable.listener.AssignInitiatorLeaderCycleTaskListener"!=e.implementation||(i=!0)})),i&&(e.returnTaskList.splice(s,1),s--)}}e.taskForm.values=null,e.returnOpen=!0})))}))},submitReturn:function(){var e=this;this.$refs["taskForm"].validate((function(t){if(t){if(!e.taskForm.targetKey)return void e.$modal.msgError("请选择退回节点！");Object(_api_workflow_task__WEBPACK_IMPORTED_MODULE_32__["h"])(e.taskForm).then((function(t){e.$modal.msgSuccess(t.msg),e.goBack()}))}}))},handleUserTabClick:function(e){this.queryParams={},this.localUserTableList=[],this.searchSelectUserName="",this.searchLocalUserName="",this.queryRoleName="",this.deptSelectName="",this.searchLocal(),this.searchSelect()},searchLocal:function(){var e=this;this.searchLocalUserName?this.localUserTableListShow=this.localUserTableList.filter((function(t){return-1!==t.nickName.indexOf(e.searchLocalUserName)})):this.localUserTableListShow=this.localUserTableList},searchSelect:function(){var e=this;this.searchSelectUserName?this.selectUserTableListShow=this.selectUserTableList.filter((function(t){return-1!==t.nickName.indexOf(e.searchSelectUserName)})):this.selectUserTableListShow=this.selectUserTableList},getUserRowKeys:function(e){return e.userId},goRight:function(){var e=this;if(0!==this.selectedLeftForms.length){if(this.isSingle)this.selectUserTableList=this.selectedLeftForms;else{this.selectUserTableList=this.selectUserTableList.concat(this.selectedLeftForms);var t=new Set,s=this.selectUserTableList.filter((function(e){return!t.has(e.userId)&&(t.add(e.userId),!0)}));this.selectUserTableList=s}this.localUserTableList=Array.from(this.localUserTableList).filter((function(t){return!e.selectedLeftForms.includes(t)})),this.searchLocal(),this.searchSelect()}},goLeft:function(){var e=this;0!==this.selectedRightForms.length&&(this.localUserTableList=this.localUserTableList.concat(this.selectedRightForms),this.selectUserTableList=Array.from(this.selectUserTableList).filter((function(t){return!e.selectedRightForms.includes(t)})),this.searchLocal(),this.searchSelect())},goRightAll:function(){this.isSingle||0===this.localUserTableList.length||(this.selectUserTableList=[],this.selectUserTableList=this.selectUserTableList.concat(this.localUserTableList),this.localUserTableList=[],this.searchLocal(),this.searchSelect())},goLeftAll:function(){0!==this.selectUserTableList.length&&(this.localUserTableList=this.localUserTableList.concat(this.selectUserTableList),this.selectUserTableList=[],this.searchLocal(),this.searchSelect())},handleDeptNodeClick:function(e){this.queryParams.deptId=e.id,this.getUserList(),this.searchLocal(),this.searchSelect()},handleDeptSelectNodeClick:function(e){this.queryParams.deptId=e.id,this.deptSelectName=e.label,this.getUserList(),this.$refs.deptSelect.blur()},selectRole:function(e){this.queryParams.roleId=e,this.getUserList()},deptSelectFilter:function(e){this.$refs.deptSelectTree.filter(e)},printFormInfo:function(){Object(_api_workflow_printDetail__WEBPACK_IMPORTED_MODULE_40__["a"])(this)},showForwardDialog:function(){this.forwardType="forward",this.forwardDialogOpen=!0},showNoteDialog:function(){this.forwardType="note",this.forwardDialogOpen=!0},handleBackHome:function(){this.forwardDialogOpen=!1,this.goBack()},wangeditorOnCreated:function(e){this.wangeditor=Object.seal(e)},handleLeftRowDoubleClick:function(e){if(this.isSingle)this.selectUserTableList=[e];else{var t=this.selectUserTableList.some((function(t){return t.userId===e.userId}));t||this.selectUserTableList.push(e)}this.localUserTableList=this.localUserTableList.filter((function(t){return t.userId!==e.userId})),this.searchLocal(),this.searchSelect()},handleRightRowDoubleClick:function(e){this.selectUserTableList=this.selectUserTableList.filter((function(t){return t.userId!==e.userId}));var t=this.localUserTableList.some((function(t){return t.userId===e.userId}));t||this.localUserTableList.push(e),this.searchLocal(),this.searchSelect()}}}},e6e7:function(e,t,s){"use strict";s("3f61")},e9fa:function(e,t,s){"use strict";s("fa00")},fa00:function(e,t,s){}}]);